/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={150(r,u,p){p.d(u,{u:()=>updateTimerInterval});var y=p(208),h=p(786),v=null;function updateTimerInterval(){if(game.user.isGM){clearInterval(v);var r=(0,h.PL)("appData").timer;r&&(v=setInterval(function(){if(Date.now()>r){clearInterval(v),ChatMessage.create({content:game.i18n.localize("".concat(y.D,".special.timer.expired")),speaker:{alias:"Timer"},whisper:ChatMessage.getWhisperRecipients("GM")});var u=(0,h.PL)("appData");return u.timer=null,void(0,h.ZC)("appData",u)}},1e3))}}},208(r,u,p){function _typeof(r){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_typeof(r)}function _regeneratorRuntime(){var r=_regenerator(),u=r.m(_regeneratorRuntime),p=(Object.getPrototypeOf?Object.getPrototypeOf(u):u.__proto__).constructor;function n(r){var u="function"==typeof r&&r.constructor;return!!u&&(u===p||"GeneratorFunction"===(u.displayName||u.name))}var y={throw:1,return:2,break:3,continue:3};function a(r){var u,p;return function(h){u||(u={stop:function stop(){return p(h.a,2)},catch:function _catch(){return h.v},abrupt:function abrupt(r,u){return p(h.a,y[r],u)},delegateYield:function delegateYield(r,y,v){return u.resultName=y,p(h.d,_regeneratorValues(r),v)},finish:function finish(r){return p(h.f,r)}},p=function t(r,p,y){h.p=u.prev,h.n=u.next;try{return r(p,y)}finally{u.next=h.n}}),u.resultName&&(u[u.resultName]=h.v,u.resultName=void 0),u.sent=h.v,u.next=h.n;try{return r.call(this,u)}finally{h.p=u.prev,h.n=u.next}}}return(_regeneratorRuntime=function _regeneratorRuntime(){return{wrap:function wrap(u,p,y,h){return r.w(a(u),p,y,h&&h.reverse())},isGeneratorFunction:n,mark:r.m,awrap:function awrap(r,u){return new _OverloadYield(r,u)},AsyncIterator:_regeneratorAsyncIterator,async:function async(r,u,p,y,h){return(n(u)?_regeneratorAsyncGen:_regeneratorAsync)(a(r),u,p,y,h)},keys:_regeneratorKeys,values:_regeneratorValues}})()}function _regeneratorValues(r){if(null!=r){var u=r["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],p=0;if(u)return u.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length))return{next:function next(){return r&&p>=r.length&&(r=void 0),{value:r&&r[p++],done:!r}}}}throw new TypeError(_typeof(r)+" is not iterable")}function _regeneratorKeys(r){var u=Object(r),p=[];for(var y in u)p.unshift(y);return function e(){for(;p.length;)if((y=p.pop())in u)return e.value=y,e.done=!1,e;return e.done=!0,e}}function _regeneratorAsync(r,u,p,y,h){var v=_regeneratorAsyncGen(r,u,p,y,h);return v.next().then(function(r){return r.done?r.value:v.next()})}function _regeneratorAsyncGen(r,u,p,y,h){return new _regeneratorAsyncIterator(_regenerator().w(r,u,p,y),h||Promise)}function _regeneratorAsyncIterator(r,u){function n(p,y,h,v){try{var b=r[p](y),w=b.value;return w instanceof _OverloadYield?u.resolve(w.v).then(function(r){n("next",r,h,v)},function(r){n("throw",r,h,v)}):u.resolve(w).then(function(r){b.value=r,h(b)},function(r){return n("throw",r,h,v)})}catch(r){v(r)}}var p;this.next||(_regeneratorDefine2(_regeneratorAsyncIterator.prototype),_regeneratorDefine2(_regeneratorAsyncIterator.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),_regeneratorDefine2(this,"_invoke",function(r,y,h){function f(){return new u(function(u,p){n(r,h,u,p)})}return p=p?p.then(f,f):f()},!0)}function _regenerator(){var r,u,p="function"==typeof Symbol?Symbol:{},y=p.iterator||"@@iterator",h=p.toStringTag||"@@toStringTag";function i(p,y,h,b){var w=y&&y.prototype instanceof Generator?y:Generator,k=Object.create(w.prototype);return _regeneratorDefine2(k,"_invoke",function(p,y,h){var b,w,k,E=0,O=h||[],P=!1,T={p:0,n:0,v:r,a:d,f:d.bind(r,4),d:function d(u,p){return b=u,w=0,k=r,T.n=p,v}};function d(p,y){for(w=p,k=y,u=0;!P&&E&&!h&&u<O.length;u++){var h,b=O[u],S=T.p,D=b[2];p>3?(h=D===y)&&(k=b[(w=b[4])?5:(w=3,3)],b[4]=b[5]=r):b[0]<=S&&((h=p<2&&S<b[1])?(w=0,T.v=y,T.n=b[1]):S<D&&(h=p<3||b[0]>y||y>D)&&(b[4]=p,b[5]=y,T.n=D,w=0))}if(h||p>1)return v;throw P=!0,y}return function(h,O,S){if(E>1)throw TypeError("Generator is already running");for(P&&1===O&&d(O,S),w=O,k=S;(u=w<2?r:k)||!P;){b||(w?w<3?(w>1&&(T.n=-1),d(w,k)):T.n=k:T.v=k);try{if(E=2,b){if(w||(h="next"),u=b[h]){if(!(u=u.call(b,k)))throw TypeError("iterator result is not an object");if(!u.done)return u;k=u.value,w<2&&(w=0)}else 1===w&&(u=b.return)&&u.call(b),w<2&&(k=TypeError("The iterator does not provide a '"+h+"' method"),w=1);b=r}else if((u=(P=T.n<0)?k:p.call(y,T))!==v)break}catch(u){b=r,w=1,k=u}finally{E=1}}return{value:u,done:P}}}(p,h,b),!0),k}var v={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}u=Object.getPrototypeOf;var b=[][y]?u(u([][y]())):(_regeneratorDefine2(u={},y,function(){return this}),u),w=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(b);function f(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,GeneratorFunctionPrototype):(r.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(r,h,"GeneratorFunction")),r.prototype=Object.create(w),r}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(w,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,h,"GeneratorFunction"),_regeneratorDefine2(w),_regeneratorDefine2(w,h,"Generator"),_regeneratorDefine2(w,y,function(){return this}),_regeneratorDefine2(w,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(r,u,p,y){var h=Object.defineProperty;try{h({},"",{})}catch(r){h=0}_regeneratorDefine2=function _regeneratorDefine(r,u,p,y){function o(u,p){_regeneratorDefine2(r,u,function(r){return this._invoke(u,p,r)})}u?h?h(r,u,{value:p,enumerable:!y,configurable:!y,writable:!y}):r[u]=p:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(r,u,p,y)}function _OverloadYield(r,u){this.v=r,this.k=u}function asyncGeneratorStep(r,u,p,y,h,v,b){try{var w=r[v](b),k=w.value}catch(r){return void p(r)}w.done?u(k):Promise.resolve(k).then(y,h)}function _asyncToGenerator(r){return function(){var u=this,p=arguments;return new Promise(function(y,h){var v=r.apply(u,p);function _next(r){asyncGeneratorStep(v,y,h,_next,_throw,"next",r)}function _throw(r){asyncGeneratorStep(v,y,h,_next,_throw,"throw",r)}_next(void 0)})}}function _defineProperties(r,u){for(var p=0;p<u.length;p++){var y=u[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(r,_toPropertyKey(y.key),y)}}function _toPropertyKey(r){var u=function _toPrimitive(r,u){if("object"!=_typeof(r)||!r)return r;var p=r[Symbol.toPrimitive];if(void 0!==p){var y=p.call(r,u||"default");if("object"!=_typeof(y))return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===u?String:Number)(r)}(r,"string");return"symbol"==_typeof(u)?u:u+""}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(r,u,p){var y=function _superPropBase(r,u){for(;!{}.hasOwnProperty.call(r,u)&&null!==(r=_getPrototypeOf(r)););return r}(r,u);if(y){var h=Object.getOwnPropertyDescriptor(y,u);return h.get?h.get.call(arguments.length<3?r:p):h.value}},_get.apply(null,arguments)}function _setPrototypeOf(r,u){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,u){return r.__proto__=u,r},_setPrototypeOf(r,u)}function _createSuper(r){var u=_isNativeReflectConstruct();return function(){var p,y=_getPrototypeOf(r);if(u){var h=_getPrototypeOf(this).constructor;p=Reflect.construct(y,arguments,h)}else p=y.apply(this,arguments);return function _possibleConstructorReturn(r,u){if(u&&("object"==_typeof(u)||"function"==typeof u))return u;if(void 0!==u)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(r)}(this,p)}}function _assertThisInitialized(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function _isNativeReflectConstruct(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(r){}return(_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!r})()}function _getPrototypeOf(r){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf(r)}p.d(u,{D:()=>I});var y=function(){!function _inherits(r,u){if("function"!=typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(u&&u.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),u&&_setPrototypeOf(r,u)}(HandlebarsApplication,foundry.applications.api.HandlebarsApplicationMixin(foundry.applications.api.ApplicationV2));var r,u,p=_createSuper(HandlebarsApplication);function HandlebarsApplication(){var r;return function _classCallCheck(r,u){if(!(r instanceof u))throw new TypeError("Cannot call a class as a function")}(this,HandlebarsApplication),(r=p.call(this)).constructor.registerPositionSetting(),r.savePosition=foundry.utils.debounce(r.savePosition.bind(_assertThisInitialized(r)),100),r}return function _createClass(r,u,p){return u&&_defineProperties(r.prototype,u),p&&_defineProperties(r,p),Object.defineProperty(r,"prototype",{writable:!1}),r}(HandlebarsApplication,[{key:"savePosition",value:function savePosition(r){var u={left:r.left,top:r.top,width:r.width,height:r.height};"auto"===u.width&&delete u.width,"auto"===u.height&&delete u.height,game.settings.set(I,this.APP_ID+"-position",u)}},{key:"setPosition",value:function setPosition(){for(var r,u=arguments.length,p=new Array(u),y=0;y<u;y++)p[y]=arguments[y];var h=(r=_get(_getPrototypeOf(HandlebarsApplication.prototype),"setPosition",this)).call.apply(r,[this].concat(p));return this.constructor.POSITION_SETTING_REGISTERED&&this.savePosition(this.position),h}},{key:"APP_ID",get:function get(){return this.constructor.APP_ID}},{key:"_prepareContext",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function _callee(r){var u;return _regeneratorRuntime().wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:if(!this.getData){r.next=2;break}return r.abrupt("return",this.getData());case 2:return u={},r.abrupt("return",{data:u});case 4:case"end":return r.stop()}},_callee,this)})),function _prepareContext(r){return u.apply(this,arguments)})},{key:"activateListeners",value:function activateListeners(){}},{key:"_onRender",value:function _onRender(r,u){_get(_getPrototypeOf(HandlebarsApplication.prototype),"_onRender",this).call(this,r,u),this.constructor.DEFAULT_OPTIONS.window.preventEscapeClose&&(foundry.applications.instances.delete(this.id,this),this.window.close.style.display="none");var p=this.element;this.activateListeners&&this.activateListeners(p)}},{key:"render",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee2(){var r,u,p,y=arguments;return _regeneratorRuntime().wrap(function _callee2$(h){for(;;)switch(h.prev=h.next){case 0:return u=y.length>1&&void 0!==y[1]?y[1]:{},!(p="boolean"==typeof(r=y.length>0&&void 0!==y[0]?y[0]:{})?u:r).position&&this.constructor.POSITION_SETTING_REGISTERED&&(p.position=game.settings.get(I,this.APP_ID+"-position")),h.abrupt("return",_get(_getPrototypeOf(HandlebarsApplication.prototype),"render",this).call(this,r,u));case 5:case"end":return h.stop()}},_callee2,this)})),function render(){return r.apply(this,arguments)})}],[{key:"registerPositionSetting",value:function registerPositionSetting(){var r;!this.POSITION_SETTING_REGISTERED&&null!==(r=this.DEFAULT_OPTIONS.window)&&void 0!==r&&r.savePosition&&(this.POSITION_SETTING_REGISTERED=!0,game.settings.register(I,this.APP_ID+"-position",{scope:"client",config:!1,type:Object,default:{}}))}},{key:"resetSavedPosition",value:function resetSavedPosition(){game.settings.set(I,this.APP_ID+"-position",{})}},{key:"APP_ID",get:function get(){return this.name.split(/(?=[A-Z])/).join("-").toLowerCase()}},{key:"PARTS",get:function get(){return{content:{template:"modules/".concat(I,"/templates/").concat(this.APP_ID,".hbs"),classes:[],scrollable:[]}}}},{key:"DEFAULT_OPTIONS",get:function get(){return{tag:"div",id:this.APP_ID,window:{title:"".concat(I,".").concat(this.APP_ID,".title"),frame:!0,positioned:!0,icon:"",controls:[],minimizable:!0,resizable:!1,contentTag:"section",contentClasses:[],savePosition:!1,preventEscapeClose:!1},actions:{},form:{handler:void 0,submitOnChange:!1,closeOnSubmit:!1},position:{width:560,height:"auto"}}}}]),HandlebarsApplication}();function mergeClone(r,u){return r=foundry.utils.deepClone(r),u=foundry.utils.deepClone(u),foundry.utils.mergeObject(r,u)}function CompendiumConfig_typeof(r){return CompendiumConfig_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},CompendiumConfig_typeof(r)}function _createForOfIteratorHelper(r,u){var p="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!p){if(Array.isArray(r)||(p=function _unsupportedIterableToArray(r,u){if(r){if("string"==typeof r)return _arrayLikeToArray(r,u);var p={}.toString.call(r).slice(8,-1);return"Object"===p&&r.constructor&&(p=r.constructor.name),"Map"===p||"Set"===p?Array.from(r):"Arguments"===p||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p)?_arrayLikeToArray(r,u):void 0}}(r))||u&&r&&"number"==typeof r.length){p&&(r=p);var y=0,h=function F(){};return{s:h,n:function n(){return y>=r.length?{done:!0}:{done:!1,value:r[y++]}},e:function e(r){throw r},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var v,b=!0,w=!1;return{s:function s(){p=p.call(r)},n:function n(){var r=p.next();return b=r.done,r},e:function e(r){w=!0,v=r},f:function f(){try{b||null==p.return||p.return()}finally{if(w)throw v}}}}function _arrayLikeToArray(r,u){(null==u||u>r.length)&&(u=r.length);for(var p=0,y=Array(u);p<u;p++)y[p]=r[p];return y}function CompendiumConfig_regeneratorRuntime(){var r=CompendiumConfig_regenerator(),u=r.m(CompendiumConfig_regeneratorRuntime),p=(Object.getPrototypeOf?Object.getPrototypeOf(u):u.__proto__).constructor;function n(r){var u="function"==typeof r&&r.constructor;return!!u&&(u===p||"GeneratorFunction"===(u.displayName||u.name))}var y={throw:1,return:2,break:3,continue:3};function a(r){var u,p;return function(h){u||(u={stop:function stop(){return p(h.a,2)},catch:function _catch(){return h.v},abrupt:function abrupt(r,u){return p(h.a,y[r],u)},delegateYield:function delegateYield(r,y,v){return u.resultName=y,p(h.d,CompendiumConfig_regeneratorValues(r),v)},finish:function finish(r){return p(h.f,r)}},p=function t(r,p,y){h.p=u.prev,h.n=u.next;try{return r(p,y)}finally{u.next=h.n}}),u.resultName&&(u[u.resultName]=h.v,u.resultName=void 0),u.sent=h.v,u.next=h.n;try{return r.call(this,u)}finally{h.p=u.prev,h.n=u.next}}}return(CompendiumConfig_regeneratorRuntime=function _regeneratorRuntime(){return{wrap:function wrap(u,p,y,h){return r.w(a(u),p,y,h&&h.reverse())},isGeneratorFunction:n,mark:r.m,awrap:function awrap(r,u){return new CompendiumConfig_OverloadYield(r,u)},AsyncIterator:CompendiumConfig_regeneratorAsyncIterator,async:function async(r,u,p,y,h){return(n(u)?CompendiumConfig_regeneratorAsyncGen:CompendiumConfig_regeneratorAsync)(a(r),u,p,y,h)},keys:CompendiumConfig_regeneratorKeys,values:CompendiumConfig_regeneratorValues}})()}function CompendiumConfig_regeneratorValues(r){if(null!=r){var u=r["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],p=0;if(u)return u.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length))return{next:function next(){return r&&p>=r.length&&(r=void 0),{value:r&&r[p++],done:!r}}}}throw new TypeError(CompendiumConfig_typeof(r)+" is not iterable")}function CompendiumConfig_regeneratorKeys(r){var u=Object(r),p=[];for(var y in u)p.unshift(y);return function e(){for(;p.length;)if((y=p.pop())in u)return e.value=y,e.done=!1,e;return e.done=!0,e}}function CompendiumConfig_regeneratorAsync(r,u,p,y,h){var v=CompendiumConfig_regeneratorAsyncGen(r,u,p,y,h);return v.next().then(function(r){return r.done?r.value:v.next()})}function CompendiumConfig_regeneratorAsyncGen(r,u,p,y,h){return new CompendiumConfig_regeneratorAsyncIterator(CompendiumConfig_regenerator().w(r,u,p,y),h||Promise)}function CompendiumConfig_regeneratorAsyncIterator(r,u){function n(p,y,h,v){try{var b=r[p](y),w=b.value;return w instanceof CompendiumConfig_OverloadYield?u.resolve(w.v).then(function(r){n("next",r,h,v)},function(r){n("throw",r,h,v)}):u.resolve(w).then(function(r){b.value=r,h(b)},function(r){return n("throw",r,h,v)})}catch(r){v(r)}}var p;this.next||(CompendiumConfig_regeneratorDefine2(CompendiumConfig_regeneratorAsyncIterator.prototype),CompendiumConfig_regeneratorDefine2(CompendiumConfig_regeneratorAsyncIterator.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),CompendiumConfig_regeneratorDefine2(this,"_invoke",function(r,y,h){function f(){return new u(function(u,p){n(r,h,u,p)})}return p=p?p.then(f,f):f()},!0)}function CompendiumConfig_regenerator(){var r,u,p="function"==typeof Symbol?Symbol:{},y=p.iterator||"@@iterator",h=p.toStringTag||"@@toStringTag";function i(p,y,h,b){var w=y&&y.prototype instanceof Generator?y:Generator,k=Object.create(w.prototype);return CompendiumConfig_regeneratorDefine2(k,"_invoke",function(p,y,h){var b,w,k,E=0,O=h||[],P=!1,T={p:0,n:0,v:r,a:d,f:d.bind(r,4),d:function d(u,p){return b=u,w=0,k=r,T.n=p,v}};function d(p,y){for(w=p,k=y,u=0;!P&&E&&!h&&u<O.length;u++){var h,b=O[u],S=T.p,D=b[2];p>3?(h=D===y)&&(k=b[(w=b[4])?5:(w=3,3)],b[4]=b[5]=r):b[0]<=S&&((h=p<2&&S<b[1])?(w=0,T.v=y,T.n=b[1]):S<D&&(h=p<3||b[0]>y||y>D)&&(b[4]=p,b[5]=y,T.n=D,w=0))}if(h||p>1)return v;throw P=!0,y}return function(h,O,S){if(E>1)throw TypeError("Generator is already running");for(P&&1===O&&d(O,S),w=O,k=S;(u=w<2?r:k)||!P;){b||(w?w<3?(w>1&&(T.n=-1),d(w,k)):T.n=k:T.v=k);try{if(E=2,b){if(w||(h="next"),u=b[h]){if(!(u=u.call(b,k)))throw TypeError("iterator result is not an object");if(!u.done)return u;k=u.value,w<2&&(w=0)}else 1===w&&(u=b.return)&&u.call(b),w<2&&(k=TypeError("The iterator does not provide a '"+h+"' method"),w=1);b=r}else if((u=(P=T.n<0)?k:p.call(y,T))!==v)break}catch(u){b=r,w=1,k=u}finally{E=1}}return{value:u,done:P}}}(p,h,b),!0),k}var v={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}u=Object.getPrototypeOf;var b=[][y]?u(u([][y]())):(CompendiumConfig_regeneratorDefine2(u={},y,function(){return this}),u),w=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(b);function f(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,GeneratorFunctionPrototype):(r.__proto__=GeneratorFunctionPrototype,CompendiumConfig_regeneratorDefine2(r,h,"GeneratorFunction")),r.prototype=Object.create(w),r}return GeneratorFunction.prototype=GeneratorFunctionPrototype,CompendiumConfig_regeneratorDefine2(w,"constructor",GeneratorFunctionPrototype),CompendiumConfig_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",CompendiumConfig_regeneratorDefine2(GeneratorFunctionPrototype,h,"GeneratorFunction"),CompendiumConfig_regeneratorDefine2(w),CompendiumConfig_regeneratorDefine2(w,h,"Generator"),CompendiumConfig_regeneratorDefine2(w,y,function(){return this}),CompendiumConfig_regeneratorDefine2(w,"toString",function(){return"[object Generator]"}),(CompendiumConfig_regenerator=function _regenerator(){return{w:i,m:f}})()}function CompendiumConfig_regeneratorDefine2(r,u,p,y){var h=Object.defineProperty;try{h({},"",{})}catch(r){h=0}CompendiumConfig_regeneratorDefine2=function _regeneratorDefine(r,u,p,y){function o(u,p){CompendiumConfig_regeneratorDefine2(r,u,function(r){return this._invoke(u,p,r)})}u?h?h(r,u,{value:p,enumerable:!y,configurable:!y,writable:!y}):r[u]=p:(o("next",0),o("throw",1),o("return",2))},CompendiumConfig_regeneratorDefine2(r,u,p,y)}function CompendiumConfig_OverloadYield(r,u){this.v=r,this.k=u}function CompendiumConfig_asyncGeneratorStep(r,u,p,y,h,v,b){try{var w=r[v](b),k=w.value}catch(r){return void p(r)}w.done?u(k):Promise.resolve(k).then(y,h)}function CompendiumConfig_asyncToGenerator(r){return function(){var u=this,p=arguments;return new Promise(function(y,h){var v=r.apply(u,p);function _next(r){CompendiumConfig_asyncGeneratorStep(v,y,h,_next,_throw,"next",r)}function _throw(r){CompendiumConfig_asyncGeneratorStep(v,y,h,_next,_throw,"throw",r)}_next(void 0)})}}function CompendiumConfig_defineProperties(r,u){for(var p=0;p<u.length;p++){var y=u[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(r,CompendiumConfig_toPropertyKey(y.key),y)}}function CompendiumConfig_toPropertyKey(r){var u=function CompendiumConfig_toPrimitive(r,u){if("object"!=CompendiumConfig_typeof(r)||!r)return r;var p=r[Symbol.toPrimitive];if(void 0!==p){var y=p.call(r,u||"default");if("object"!=CompendiumConfig_typeof(y))return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===u?String:Number)(r)}(r,"string");return"symbol"==CompendiumConfig_typeof(u)?u:u+""}function CompendiumConfig_get(){return CompendiumConfig_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(r,u,p){var y=function CompendiumConfig_superPropBase(r,u){for(;!{}.hasOwnProperty.call(r,u)&&null!==(r=CompendiumConfig_getPrototypeOf(r)););return r}(r,u);if(y){var h=Object.getOwnPropertyDescriptor(y,u);return h.get?h.get.call(arguments.length<3?r:p):h.value}},CompendiumConfig_get.apply(null,arguments)}function CompendiumConfig_setPrototypeOf(r,u){return CompendiumConfig_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,u){return r.__proto__=u,r},CompendiumConfig_setPrototypeOf(r,u)}function CompendiumConfig_createSuper(r){var u=CompendiumConfig_isNativeReflectConstruct();return function(){var p,y=CompendiumConfig_getPrototypeOf(r);if(u){var h=CompendiumConfig_getPrototypeOf(this).constructor;p=Reflect.construct(y,arguments,h)}else p=y.apply(this,arguments);return function CompendiumConfig_possibleConstructorReturn(r,u){if(u&&("object"==CompendiumConfig_typeof(u)||"function"==typeof u))return u;if(void 0!==u)throw new TypeError("Derived constructors may only return object or undefined");return function CompendiumConfig_assertThisInitialized(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}(r)}(this,p)}}function CompendiumConfig_isNativeReflectConstruct(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(r){}return(CompendiumConfig_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!r})()}function CompendiumConfig_getPrototypeOf(r){return CompendiumConfig_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},CompendiumConfig_getPrototypeOf(r)}function _classStaticPrivateMethodGet(r,u,p){return function _assertClassBrand(r,u,p){if("function"==typeof r?r===u:r.has(u))return arguments.length<3?u:p;throw new TypeError("Private element is not present on this object")}(u,r),p}var h=function(r){!function CompendiumConfig_inherits(r,u){if("function"!=typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(u&&u.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),u&&CompendiumConfig_setPrototypeOf(r,u)}(CompendiumConfig,r);var u,p=CompendiumConfig_createSuper(CompendiumConfig);function CompendiumConfig(){return function CompendiumConfig_classCallCheck(r,u){if(!(r instanceof u))throw new TypeError("Cannot call a class as a function")}(this,CompendiumConfig),p.call(this)}return function CompendiumConfig_createClass(r,u,p){return u&&CompendiumConfig_defineProperties(r.prototype,u),p&&CompendiumConfig_defineProperties(r,p),Object.defineProperty(r,"prototype",{writable:!1}),r}(CompendiumConfig,[{key:"SETTING_KEY",get:function get(){return this.constructor.SETTING_KEY}},{key:"_prepareContext",value:(u=CompendiumConfig_asyncToGenerator(CompendiumConfig_regeneratorRuntime().mark(function _callee(r){var u,p,y,h,v,b,w,k,E,O,P,T,S,D,A,x,R,G;return CompendiumConfig_regeneratorRuntime().wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:for(u=game.settings.get(I,this.SETTING_KEY),p=Array.from(game.packs),y=[],h=0,v=p;h<v.length;h++)E=v[h],O=E.metadata.id,y.push({id:O,checked:null===(b=u[O])||void 0===b||b,name:E.metadata.label,package:null!==(w="system"===E.metadata.packageType?game.system.title:null===(k=game.modules.get(E.metadata.packageName))||void 0===k?void 0:k.title)&&void 0!==w?w:game.i18n.localize("PACKAGE.Type.world")});for(y.sort(function(r,u){return r.package.localeCompare(u.package)}),P={},T=0,S=y;T<S.length;T++)D=S[T],P[D.package]||(P[D.package]=[]),P[D.package].push(D);for(A in P)P[A].sort(function(r,u){return r.name.localeCompare(u.name)});return x={type:"button",action:"onCheckAll",icon:"fas fa-check-square",label:"Select All"},R={type:"button",action:"onUncheckAll",icon:"fas fa-square",label:"Unselect All"},G={type:"submit",action:"submit",icon:"fas fa-save",label:"Save"},r.abrupt("return",{compendiumsByPackage:P,buttons:[x,R,G]});case 12:case"end":return r.stop()}},_callee,this)})),function _prepareContext(r){return u.apply(this,arguments)})},{key:"_onRender",value:function _onRender(r,u){CompendiumConfig_get(CompendiumConfig_getPrototypeOf(CompendiumConfig.prototype),"_onRender",this).call(this,r,u);var p=this.element;p.querySelectorAll(".check-all").forEach(function(r){r.addEventListener("click",function(u){u.preventDefault();var p,y=_createForOfIteratorHelper(r.closest("fieldset").querySelectorAll("input[type=checkbox]"));try{for(y.s();!(p=y.n()).done;){p.value.checked=!0}}catch(r){y.e(r)}finally{y.f()}})}),p.querySelectorAll(".uncheck-all").forEach(function(r){r.addEventListener("click",function(u){u.preventDefault();var p,y=_createForOfIteratorHelper(r.closest("fieldset").querySelectorAll("input[type=checkbox]"));try{for(y.s();!(p=y.n()).done;){p.value.checked=!1}}catch(r){y.e(r)}finally{y.f()}})})}}],[{key:"SETTING_KEY",get:function get(){return this.name.charAt(0).toLowerCase()+this.name.slice(1)}},{key:"DEFAULT_OPTIONS",get:function get(){return mergeClone(CompendiumConfig_get(CompendiumConfig_getPrototypeOf(CompendiumConfig),"DEFAULT_OPTIONS",this),{tag:"form",window:{title:game.i18n.localize("".concat(I,".settings.").concat(this.SETTING_KEY,".label")),contentClasses:["standard-form"]},actions:{onCheckAll:this.checkAll,onUncheckAll:this.uncheckAll},form:{handler:_classStaticPrivateMethodGet(this,CompendiumConfig,_onSubmit),closeOnSubmit:!0},position:{width:800}})}},{key:"PARTS",get:function get(){return{content:{template:"modules/".concat(I,"/templates/").concat(this.APP_ID,".hbs"),classes:["standard-form","scrollable"]},footer:{template:"templates/generic/form-footer.hbs"}}}},{key:"checkAll",value:function checkAll(){var r,u=_createForOfIteratorHelper(this.element.querySelectorAll("input[type=checkbox]"));try{for(u.s();!(r=u.n()).done;){r.value.checked=!0}}catch(r){u.e(r)}finally{u.f()}}},{key:"uncheckAll",value:function uncheckAll(){var r,u=_createForOfIteratorHelper(this.element.querySelectorAll("input[type=checkbox]"));try{for(u.s();!(r=u.n()).done;){r.value.checked=!1}}catch(r){u.e(r)}finally{u.f()}}},{key:"register",value:function register(){game.settings.registerMenu(I,this.APP_ID,{name:game.i18n.localize("".concat(I,".settings.").concat(this.SETTING_KEY,".name")),label:game.i18n.localize("".concat(I,".settings.").concat(this.SETTING_KEY,".label")),hint:game.i18n.localize("".concat(I,".settings.").concat(this.SETTING_KEY,".hint")),icon:"fas fa-atlas",type:this,restricted:!0,scope:"world"}),game.settings.register(I,this.SETTING_KEY,{scope:"world",config:!1,default:{},type:Object})}}]),CompendiumConfig}(y);function _onSubmit(){return _onSubmit3.apply(this,arguments)}function _onSubmit3(){return(_onSubmit3=CompendiumConfig_asyncToGenerator(CompendiumConfig_regeneratorRuntime().mark(function _callee2(){var r,u,p;return CompendiumConfig_regeneratorRuntime().wrap(function _callee2$(y){for(;;)switch(y.prev=y.next){case 0:return r=this.element,u=new foundry.applications.ux.FormDataExtended(r).object,y.next=4,game.settings.set(I,this.SETTING_KEY,u);case 4:return p=y.sent,CONFIG.SpotlightOmnisearch.rebuildIndex(),y.abrupt("return",p);case 7:case"end":return y.stop()}},_callee2,this)}))).apply(this,arguments)}var v=p(508),b=p(717),w=p(786),k=p(636);function spotlight_typeof(r){return spotlight_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},spotlight_typeof(r)}function _slicedToArray(r,u){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,u){var p=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=p){var y,h,v,b,w=[],k=!0,E=!1;try{if(v=(p=p.call(r)).next,0===u){if(Object(p)!==p)return;k=!1}else for(;!(k=(y=v.call(p)).done)&&(w.push(y.value),w.length!==u);k=!0);}catch(r){E=!0,h=r}finally{try{if(!k&&null!=p.return&&(b=p.return(),Object(b)!==b))return}finally{if(E)throw h}}return w}}(r,u)||spotlight_unsupportedIterableToArray(r,u)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(r){return function _arrayWithoutHoles(r){if(Array.isArray(r))return spotlight_arrayLikeToArray(r)}(r)||function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||spotlight_unsupportedIterableToArray(r)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function spotlight_regeneratorRuntime(){var r=spotlight_regenerator(),u=r.m(spotlight_regeneratorRuntime),p=(Object.getPrototypeOf?Object.getPrototypeOf(u):u.__proto__).constructor;function n(r){var u="function"==typeof r&&r.constructor;return!!u&&(u===p||"GeneratorFunction"===(u.displayName||u.name))}var y={throw:1,return:2,break:3,continue:3};function a(r){var u,p;return function(h){u||(u={stop:function stop(){return p(h.a,2)},catch:function _catch(){return h.v},abrupt:function abrupt(r,u){return p(h.a,y[r],u)},delegateYield:function delegateYield(r,y,v){return u.resultName=y,p(h.d,spotlight_regeneratorValues(r),v)},finish:function finish(r){return p(h.f,r)}},p=function t(r,p,y){h.p=u.prev,h.n=u.next;try{return r(p,y)}finally{u.next=h.n}}),u.resultName&&(u[u.resultName]=h.v,u.resultName=void 0),u.sent=h.v,u.next=h.n;try{return r.call(this,u)}finally{h.p=u.prev,h.n=u.next}}}return(spotlight_regeneratorRuntime=function _regeneratorRuntime(){return{wrap:function wrap(u,p,y,h){return r.w(a(u),p,y,h&&h.reverse())},isGeneratorFunction:n,mark:r.m,awrap:function awrap(r,u){return new spotlight_OverloadYield(r,u)},AsyncIterator:spotlight_regeneratorAsyncIterator,async:function async(r,u,p,y,h){return(n(u)?spotlight_regeneratorAsyncGen:spotlight_regeneratorAsync)(a(r),u,p,y,h)},keys:spotlight_regeneratorKeys,values:spotlight_regeneratorValues}})()}function spotlight_regeneratorValues(r){if(null!=r){var u=r["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],p=0;if(u)return u.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length))return{next:function next(){return r&&p>=r.length&&(r=void 0),{value:r&&r[p++],done:!r}}}}throw new TypeError(spotlight_typeof(r)+" is not iterable")}function spotlight_regeneratorKeys(r){var u=Object(r),p=[];for(var y in u)p.unshift(y);return function e(){for(;p.length;)if((y=p.pop())in u)return e.value=y,e.done=!1,e;return e.done=!0,e}}function spotlight_regeneratorAsync(r,u,p,y,h){var v=spotlight_regeneratorAsyncGen(r,u,p,y,h);return v.next().then(function(r){return r.done?r.value:v.next()})}function spotlight_regeneratorAsyncGen(r,u,p,y,h){return new spotlight_regeneratorAsyncIterator(spotlight_regenerator().w(r,u,p,y),h||Promise)}function spotlight_regeneratorAsyncIterator(r,u){function n(p,y,h,v){try{var b=r[p](y),w=b.value;return w instanceof spotlight_OverloadYield?u.resolve(w.v).then(function(r){n("next",r,h,v)},function(r){n("throw",r,h,v)}):u.resolve(w).then(function(r){b.value=r,h(b)},function(r){return n("throw",r,h,v)})}catch(r){v(r)}}var p;this.next||(spotlight_regeneratorDefine2(spotlight_regeneratorAsyncIterator.prototype),spotlight_regeneratorDefine2(spotlight_regeneratorAsyncIterator.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),spotlight_regeneratorDefine2(this,"_invoke",function(r,y,h){function f(){return new u(function(u,p){n(r,h,u,p)})}return p=p?p.then(f,f):f()},!0)}function spotlight_regenerator(){var r,u,p="function"==typeof Symbol?Symbol:{},y=p.iterator||"@@iterator",h=p.toStringTag||"@@toStringTag";function i(p,y,h,b){var w=y&&y.prototype instanceof Generator?y:Generator,k=Object.create(w.prototype);return spotlight_regeneratorDefine2(k,"_invoke",function(p,y,h){var b,w,k,E=0,O=h||[],P=!1,T={p:0,n:0,v:r,a:d,f:d.bind(r,4),d:function d(u,p){return b=u,w=0,k=r,T.n=p,v}};function d(p,y){for(w=p,k=y,u=0;!P&&E&&!h&&u<O.length;u++){var h,b=O[u],S=T.p,D=b[2];p>3?(h=D===y)&&(k=b[(w=b[4])?5:(w=3,3)],b[4]=b[5]=r):b[0]<=S&&((h=p<2&&S<b[1])?(w=0,T.v=y,T.n=b[1]):S<D&&(h=p<3||b[0]>y||y>D)&&(b[4]=p,b[5]=y,T.n=D,w=0))}if(h||p>1)return v;throw P=!0,y}return function(h,O,S){if(E>1)throw TypeError("Generator is already running");for(P&&1===O&&d(O,S),w=O,k=S;(u=w<2?r:k)||!P;){b||(w?w<3?(w>1&&(T.n=-1),d(w,k)):T.n=k:T.v=k);try{if(E=2,b){if(w||(h="next"),u=b[h]){if(!(u=u.call(b,k)))throw TypeError("iterator result is not an object");if(!u.done)return u;k=u.value,w<2&&(w=0)}else 1===w&&(u=b.return)&&u.call(b),w<2&&(k=TypeError("The iterator does not provide a '"+h+"' method"),w=1);b=r}else if((u=(P=T.n<0)?k:p.call(y,T))!==v)break}catch(u){b=r,w=1,k=u}finally{E=1}}return{value:u,done:P}}}(p,h,b),!0),k}var v={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}u=Object.getPrototypeOf;var b=[][y]?u(u([][y]())):(spotlight_regeneratorDefine2(u={},y,function(){return this}),u),w=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(b);function f(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,GeneratorFunctionPrototype):(r.__proto__=GeneratorFunctionPrototype,spotlight_regeneratorDefine2(r,h,"GeneratorFunction")),r.prototype=Object.create(w),r}return GeneratorFunction.prototype=GeneratorFunctionPrototype,spotlight_regeneratorDefine2(w,"constructor",GeneratorFunctionPrototype),spotlight_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",spotlight_regeneratorDefine2(GeneratorFunctionPrototype,h,"GeneratorFunction"),spotlight_regeneratorDefine2(w),spotlight_regeneratorDefine2(w,h,"Generator"),spotlight_regeneratorDefine2(w,y,function(){return this}),spotlight_regeneratorDefine2(w,"toString",function(){return"[object Generator]"}),(spotlight_regenerator=function _regenerator(){return{w:i,m:f}})()}function spotlight_regeneratorDefine2(r,u,p,y){var h=Object.defineProperty;try{h({},"",{})}catch(r){h=0}spotlight_regeneratorDefine2=function _regeneratorDefine(r,u,p,y){function o(u,p){spotlight_regeneratorDefine2(r,u,function(r){return this._invoke(u,p,r)})}u?h?h(r,u,{value:p,enumerable:!y,configurable:!y,writable:!y}):r[u]=p:(o("next",0),o("throw",1),o("return",2))},spotlight_regeneratorDefine2(r,u,p,y)}function spotlight_OverloadYield(r,u){this.v=r,this.k=u}function spotlight_asyncGeneratorStep(r,u,p,y,h,v,b){try{var w=r[v](b),k=w.value}catch(r){return void p(r)}w.done?u(k):Promise.resolve(k).then(y,h)}function spotlight_asyncToGenerator(r){return function(){var u=this,p=arguments;return new Promise(function(y,h){var v=r.apply(u,p);function _next(r){spotlight_asyncGeneratorStep(v,y,h,_next,_throw,"next",r)}function _throw(r){spotlight_asyncGeneratorStep(v,y,h,_next,_throw,"throw",r)}_next(void 0)})}}function spotlight_createForOfIteratorHelper(r,u){var p="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!p){if(Array.isArray(r)||(p=spotlight_unsupportedIterableToArray(r))||u&&r&&"number"==typeof r.length){p&&(r=p);var y=0,h=function F(){};return{s:h,n:function n(){return y>=r.length?{done:!0}:{done:!1,value:r[y++]}},e:function e(r){throw r},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var v,b=!0,w=!1;return{s:function s(){p=p.call(r)},n:function n(){var r=p.next();return b=r.done,r},e:function e(r){w=!0,v=r},f:function f(){try{b||null==p.return||p.return()}finally{if(w)throw v}}}}function spotlight_unsupportedIterableToArray(r,u){if(r){if("string"==typeof r)return spotlight_arrayLikeToArray(r,u);var p={}.toString.call(r).slice(8,-1);return"Object"===p&&r.constructor&&(p=r.constructor.name),"Map"===p||"Set"===p?Array.from(r):"Arguments"===p||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p)?spotlight_arrayLikeToArray(r,u):void 0}}function spotlight_arrayLikeToArray(r,u){(null==u||u>r.length)&&(u=r.length);for(var p=0,y=Array(u);p<u;p++)y[p]=r[p];return y}function spotlight_classCallCheck(r,u){if(!(r instanceof u))throw new TypeError("Cannot call a class as a function")}function spotlight_defineProperties(r,u){for(var p=0;p<u.length;p++){var y=u[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(r,spotlight_toPropertyKey(y.key),y)}}function spotlight_createClass(r,u,p){return u&&spotlight_defineProperties(r.prototype,u),p&&spotlight_defineProperties(r,p),Object.defineProperty(r,"prototype",{writable:!1}),r}function spotlight_toPropertyKey(r){var u=function spotlight_toPrimitive(r,u){if("object"!=spotlight_typeof(r)||!r)return r;var p=r[Symbol.toPrimitive];if(void 0!==p){var y=p.call(r,u||"default");if("object"!=spotlight_typeof(y))return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===u?String:Number)(r)}(r,"string");return"symbol"==spotlight_typeof(u)?u:u+""}function spotlight_get(){return spotlight_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(r,u,p){var y=function spotlight_superPropBase(r,u){for(;!{}.hasOwnProperty.call(r,u)&&null!==(r=spotlight_getPrototypeOf(r)););return r}(r,u);if(y){var h=Object.getOwnPropertyDescriptor(y,u);return h.get?h.get.call(arguments.length<3?r:p):h.value}},spotlight_get.apply(null,arguments)}function spotlight_setPrototypeOf(r,u){return spotlight_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,u){return r.__proto__=u,r},spotlight_setPrototypeOf(r,u)}function spotlight_createSuper(r){var u=spotlight_isNativeReflectConstruct();return function(){var p,y=spotlight_getPrototypeOf(r);if(u){var h=spotlight_getPrototypeOf(this).constructor;p=Reflect.construct(y,arguments,h)}else p=y.apply(this,arguments);return function spotlight_possibleConstructorReturn(r,u){if(u&&("object"==spotlight_typeof(u)||"function"==typeof u))return u;if(void 0!==u)throw new TypeError("Derived constructors may only return object or undefined");return spotlight_assertThisInitialized(r)}(this,p)}}function spotlight_assertThisInitialized(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function spotlight_isNativeReflectConstruct(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(r){}return(spotlight_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!r})()}function spotlight_getPrototypeOf(r){return spotlight_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},spotlight_getPrototypeOf(r)}var E=700,O={query:"",filters:[]},P=0,T=function(r){!function spotlight_inherits(r,u){if("function"!=typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(u&&u.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),u&&spotlight_setPrototypeOf(r,u)}(Spotlight,r);var u,p,y=spotlight_createSuper(Spotlight);function Spotlight(){var r,u,p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=p.first,v=p.toTaskbar,b=p.isPrompt,k=p.promptOptions;return spotlight_classCallCheck(this,Spotlight),u=y.call(this),E=(0,w.PL)("spotlightWidth")||700,u.promise=new Promise(function(r){u._resolve=r}),u.first=h,u.toTaskbar=v,u.isPrompt=b,u.promptOptions=k,u.ACTOR_ITEMS_INDEX=[],null===(r=ui.spotlightOmnisearch)||void 0===r||r.close(),ui.spotlightOmnisearch=spotlight_assertThisInitialized(u),u._onSearch=foundry.utils.debounce(u._onSearch,167),u.updateStoredPosition=foundry.utils.debounce(u.updateStoredPosition,167),document.addEventListener("mousedown",Spotlight.onClickAway),u.indexActorItems(),u}return spotlight_createClass(Spotlight,[{key:"indexActorItems",value:function indexActorItems(){var r,u,p=this,y=null!==(r=null===(u=canvas)||void 0===u||null===(u=u.tokens)||void 0===u?void 0:u.controlled.map(function(r){return r.actor}))&&void 0!==r?r:[];_token&&!y.includes(_token.actor)&&y.push(_token.actor),y.includes(game.user.character)||y.push(game.user.character);var h,v=spotlight_createForOfIteratorHelper(y);try{var b=function _loop(){var r,u=h.value;if(!u)return"continue";var y=u.items.map(function(r){var p,y,h=[];return r.use&&h.push({name:"".concat(I,".actions.use-item"),icon:'<i class="fas fa-hand-paper"></i>',callback:(p=spotlight_asyncToGenerator(spotlight_regeneratorRuntime().mark(function _callee(){return spotlight_regeneratorRuntime().wrap(function _callee$(u){for(;;)switch(u.prev=u.next){case 0:r.use();case 1:case"end":return u.stop()}},_callee)})),function callback(){return p.apply(this,arguments)})}),new k.g({name:r.name,type:"Item owned",description:u.name,img:r.img,icon:["fas fa-user-circle","fas fa-suitcase"],data:{uuid:r.uuid,documentName:"Item"},actions:h,onClick:(y=spotlight_asyncToGenerator(spotlight_regeneratorRuntime().mark(function _callee2(){return spotlight_regeneratorRuntime().wrap(function _callee2$(u){for(;;)switch(u.prev=u.next){case 0:r.sheet.render(!0);case 1:case"end":return u.stop()}},_callee2)})),function onClick(){return y.apply(this,arguments)})})});(r=p.ACTOR_ITEMS_INDEX).push.apply(r,_toConsumableArray(y))};for(v.s();!(h=v.n()).done;)b()}catch(r){v.e(r)}finally{v.f()}}},{key:"_prepareContext",value:(p=spotlight_asyncToGenerator(spotlight_regeneratorRuntime().mark(function _callee3(r){var u,p;return spotlight_regeneratorRuntime().wrap(function _callee3$(r){for(;;)switch(r.prev=r.next){case 0:if(u=(0,w.PL)("appData"),(0,w.PL)("saveLastSearch")||(O={query:"",filters:[]}),p=u.timer,!(game.user.isGM&&p&&Date.now()>p)){r.next=8;break}return delete u.timer,r.next=8,(0,w.ZC)("appData",u);case 8:return r.abrupt("return",{first:this.first,lastSearch:O.query});case 9:case"end":return r.stop()}},_callee3,this)})),function _prepareContext(r){return p.apply(this,arguments)})},{key:"_onRender",value:function _onRender(r,u){var p,y=this;spotlight_get(spotlight_getPrototypeOf(Spotlight.prototype),"_onRender",this).call(this,r,u);var h=this.element,v=h.closest("#spotlight");this._html=h,(0,b.Xh)().then(function(r){r&&y._onSearch()}),this.toTaskbar&&v.classList.add("to-taskbar");var k=h.querySelector(".filters-container");O.filters.forEach(function(r){var u=document.createElement("span");u.innerText=r,u.classList.add("filter"),u.dataset.filter=r,u.addEventListener("click",function(r){r.preventDefault(),r.stopPropagation(),u.remove(),y._onSearch()}),k.appendChild(u)}),h.querySelector("input").addEventListener("input",this._onSearch.bind(this)),h.querySelector("input").addEventListener("keydown",this._onKeyDown.bind(this)),setTimeout(function(){h.querySelector("input").disabled=!1,h.querySelector("input").focus()},50),h.closest("#spotlight").classList.add("force-opacity"),setTimeout(function(){h.closest("#spotlight").classList.remove("force-opacity")},300);var P=(0,w.PL)("position"),T=(0,w.PL)("spotlightPosition");T&&"save"===P&&(T.left+E>window.innerWidth||T.top>window.innerHeight||T.top<0||T.left<0||this.setPosition({left:T.left,top:T.top,width:E})),(0,w.PL)("alwaysOnTop")&&(h.closest("#spotlight").style.zIndex="9999 !important"),this.first&&(h.querySelector("input").value="?"),null!==(p=this.promptOptions)&&void 0!==p&&p.query&&(h.querySelector("input").value=this.promptOptions.query),this._onSearch()}},{key:"setPosition",value:function setPosition(){var r;if(this.element){for(var u=arguments.length,p=new Array(u),y=0;y<u;y++)p[y]=arguments[y];(r=spotlight_get(spotlight_getPrototypeOf(Spotlight.prototype),"setPosition",this)).call.apply(r,[this].concat(p));var h=this._html.closest("#spotlight"),v=h.getBoundingClientRect().top,b=window.innerHeight-v-100,w=this._html.querySelector(".search-section").style.maxHeight;if(this._html.querySelector(".search-section").style.maxHeight="".concat(b,"px"),w!==this._html.querySelector(".search-section").style.maxHeight){var k=h.classList.contains("to-taskbar");h.classList.toggle("inverted",b<window.innerHeight/3||k),this.setPosition({height:"auto"})}this.updateStoredPosition()}}},{key:"updateStoredPosition",value:function updateStoredPosition(){(0,w.ZC)("spotlightPosition",{left:this.position.left,top:this.position.top})}},{key:"_getFilters",value:function _getFilters(r){for(var u=[];r.includes("!");){var p=r.match(/^!(\S+)/g);if(!p)break;u.push(p[0].replace("!","").toLowerCase()),r=r.replace(p[0],"").trim()}return{filters:u,query:r}}},{key:"_onKeyDown",value:function _onKeyDown(r){var u=this._html,p=Date.now(),y=p-P;if(u.querySelector(".input-suggestion").innerText="",P=p,"Enter"===r.key){r.preventDefault();var h=r.shiftKey,v=r.altKey,b=u.querySelector(".search-item:not(.type-header).selected"),w=null!=b?b:u.querySelector(".search-item:not(.type-header)"),k=null==w?void 0:w.querySelector(".search-item-actions button.selected");if(k)return k.click(),this.close();if(!w)return;if(h){var E=w.querySelector(".search-item-actions button");E&&E.click()}else if(v){var O=w.querySelectorAll(".search-item-actions button")[1];O&&O.click()}else null==w||w.click();this.close()}if("Escape"===r.key&&this.close(),"Backspace"===r.key&&!u.querySelector("input").value){var T=u.querySelectorAll(".filters-container .filter"),S=T[T.length-1];S&&S.remove(),this._onSearch()}if("ArrowUp"===r.key||"ArrowDown"===r.key){u.querySelectorAll("button").forEach(function(r){return r.classList.remove("selected")});var D,A=u.querySelector(".search-item.selected");if(!A){var I=u.querySelector(".search-item:not(.type-header)");return void(I&&I.classList.add("selected"))}if(r.ctrlKey){for(D=A["ArrowUp"===r.key?"previousElementSibling":"nextElementSibling"];D&&!D.classList.contains("type-header");)D=D["ArrowUp"===r.key?"previousElementSibling":"nextElementSibling"];if(D&&(D=D["ArrowUp"===r.key?"previousElementSibling":"nextElementSibling"],"ArrowUp"===r.key)){for(;D&&!D.classList.contains("type-header");)D=D.previousElementSibling;D=D.nextElementSibling}}else(D=A["ArrowUp"===r.key?"previousElementSibling":"nextElementSibling"])&&D.classList.contains("type-header")&&(D=D["ArrowUp"===r.key?"previousElementSibling":"nextElementSibling"]);D&&(A.classList.remove("selected"),D.classList.add("selected"),D.scrollIntoView({block:"nearest",behavior:"smooth"}))}if("ArrowLeft"===r.key||"ArrowRight"===r.key){var x=u.querySelector(".search-item.selected");if(!x)return;var R=x.querySelectorAll(".search-item-actions button");if(!R.length)return;var G,L,M,N=x.querySelector(".search-item-actions button.selected");if(!N)return void R[0].classList.add("selected");if("ArrowLeft"===r.key)G=null!==(L=N.previousElementSibling)&&void 0!==L?L:R[R.length-1];else G=null!==(M=N.nextElementSibling)&&void 0!==M?M:R[0];N.classList.remove("selected"),G.classList.add("selected")}" "===r.key&&r.shiftKey&&y<400&&this.close()}},{key:"_onSearch",value:function _onSearch(){var r=this;if(!this.closing){var u=this._html.querySelector("input"),p=this._html.querySelector(".input-suggestion"),y=u.value.toLowerCase(),h=(y=function convertFullWidthToRegular(r){var u="０１２３４５６７８９",p="0123456789",y=new RegExp("["+u+"]","g");return r.replace(y,function(r){return p[u.indexOf(r)]})}(y)).includes(" ");(y=y.trim())||(p.innerText="");var k=this._getFilters(y),E=k.filters;y=k.query;var P=E.length>0;if(P){var T=b.SC.filter(function(r){return r.startsWith(E[0])}),S="".concat(T.join(" / ")).replace(E[0],""),A=document.createElement("span");A.classList.add("input-spacer"),A.innerText=u.value,p.appendChild(A),p.innerHTML+=S}if(P&&h){var x=this._html.querySelector(".filters-container");E.forEach(function(y){var h=document.createElement("span"),v=b.SC.filter(function(r){return r.startsWith(y)}),w=1===v.length?v[0]:y;h.innerText=w,h.classList.add("filter"),h.dataset.filter=w,h.addEventListener("click",function(u){u.preventDefault(),u.stopPropagation(),h.remove(),r._onSearch()}),x.appendChild(h),u.value=r._html.querySelector("input").value.replace("!".concat(y),"").trim(),p.innerText=""})}this._html.querySelectorAll(".filters-container .filter").forEach(function(r){E.push(r.dataset.filter)}),P=E.length>0,O={query:y,filters:E};var R=this._html.querySelector(".search-section"),G=!!(0,w.PL)("appData").timer;if(R.classList.toggle("no-results",!y&&!G&&!P),!y&&!G&&!P)return this._html.querySelector("#search-result").innerHTML="",void this.setPosition({height:"auto"});var L=[],M=function completeSearch(){var y,h={"special-app":[],"recent-searches":[]},v=(0,w.PL)("useHistory")&&null!==(y=(0,w.PL)("recent"))&&void 0!==y?y:[],b=document.createElement("li");b.classList.add("type-header"),b.style.justifyContent="space-between",b.style.background="none",b.innerHTML="".concat(game.i18n.localize("".concat(I,".recent-searches")),' <span class="clear-recent"><i data-tooltip="').concat(game.i18n.localize("".concat(I,".recent-tooltip")),'" style="cursor: pointer;pointer-events: all;" class="fas fa-trash-clock"></i></span>'),b.querySelector("i").addEventListener("click",function(){(0,w.ZC)("recent",[]),r._onSearch()}),L.forEach(function(r){v.includes(r.name)?h["recent-searches"].push(r):(h[r.type]||(h[r.type]=[]),h[r.type].push(r))});var k=!1,E=r._html.querySelector("#search-result");E.innerHTML="";for(var O=function _loop2(){var r=_slicedToArray(T[P],2),y=r[0],h=r[1];if(!h.length)return"continue";var v=[],w=[];h.forEach(function(r){var u=r.name.toLowerCase();B.some(function(r){return u.startsWith(r)})?v.push(r):w.push(r)}),w.sort(function(r,u){return r.name.localeCompare(u.name)}),v.sort(function(r,u){return r.name.localeCompare(u.name)}),v.push.apply(v,w);var O=document.createElement("li");O.innerText=y.replaceAll("-"," ").replaceAll(" "," - ").replace(/([a-z])([A-Z])/g,"$1 $2"),O.classList.add("type-header"),"recent-searches"===y&&(O=b),y.includes("special-app")||E.appendChild(O),v.forEach(function(r){if(!k)if(k=!0,p.innerText)p.innerHTML=p.innerText;else{var y=document.createElement("span");y.classList.add("input-spacer"),y.innerText=u.value,p.appendChild(y),p.innerHTML+=" "+r.name}E.appendChild(r.element)})},P=0,T=Object.entries(h);P<T.length;P++)O();L.length||R.classList.add("no-results"),r.setPosition({height:"auto"}),u.placeholder=""};y=foundry.applications.ux.SearchFilter.cleanQuery(y);var N,j=spotlight_createForOfIteratorHelper(v.R);try{var U=function _loop6(){var r=N.value;return r.query=y,P&&!E.every(function(u){return r.type.toLowerCase().includes(u)})?"continue":G&&r.type.includes("timer")?(L.push(new D(r)),y?"continue":"break"):void(r.match(y)&&L.push(new D(r)))};for(j.s();!(N=j.n()).done;){var K=U();if("continue"!==K&&"break"===K)break}}catch(r){j.e(r)}finally{j.f()}var B=y.split(" ").map(function(r){return r.trim()}).filter(function(r){return r});if(!y&&G)return M();for(var W=function _loop3(){if(L.length>50)return"break";var u=r.ACTOR_ITEMS_INDEX[z];if(u.query=y,P&&!E.every(function(r){return u.type.toLowerCase().includes(r)}))return"continue";B.every(function(r){return u.match(r)})&&L.push(new D(u))},z=0;z<this.ACTOR_ITEMS_INDEX.length;z++){var q=W();if("break"===q)break}for(var $=function _loop4(){if(L.length>50)return"break";var r=b.hx[H];if(r.query=y,P&&!E.every(function(u){return r.type.toLowerCase().includes(u)}))return"continue";B.every(function(u){return r.match(u)})&&L.push(new D(r))},H=0;H<b.hx.length;H++){var Y=$();if("break"===Y)break}for(var V=function _loop5(){if(L.length>50)return"break";var r=b.iu[Z];if(r.query=y,P&&!E.some(function(u){return r.type.toLowerCase().includes(u)}))return"continue";B.every(function(u){return r.match(u)})&&L.push(new D(r))},Z=0;Z<b.iu.length;Z++){var J=V();if("break"===J)break}M()}}},{key:"setDraggingState",value:function setDraggingState(r){var u=this;setTimeout(function(){u._html.closest("#spotlight").classList.toggle("dragging",r)},1)}},{key:"close",value:(u=spotlight_asyncToGenerator(spotlight_regeneratorRuntime().mark(function _callee4(){var r,u=arguments;return spotlight_regeneratorRuntime().wrap(function _callee4$(p){for(;;)switch(p.prev=p.next){case 0:return r=u.length>0&&void 0!==u[0]?u[0]:{},ui.spotlightOmnisearch=null,this._resolve(r.result),document.removeEventListener("mousedown",Spotlight.onClickAway),p.abrupt("return",spotlight_get(spotlight_getPrototypeOf(Spotlight.prototype),"close",this).call(this,r));case 5:case"end":return p.stop()}},_callee4,this)})),function close(){return u.apply(this,arguments)})}],[{key:"DEFAULT_OPTIONS",get:function get(){return mergeClone(spotlight_get(spotlight_getPrototypeOf(Spotlight),"DEFAULT_OPTIONS",this),{classes:(0,w.PL)("compactMode")?["compact"]:[],window:{title:"".concat(I,".").concat(this.APP_ID,".title")},position:{width:E,height:"auto"}})}},{key:"onClickAway",value:function onClickAway(r){var u;(0,w.PL)("clickToDismiss")&&(r.target.closest("#spotlight")||null===(u=ui.spotlightOmnisearch)||void 0===u||u.close())}},{key:"toTaskbar",value:function toTaskbar(r){var u=r.left;r.bottom;new Spotlight({toTaskbar:u}).render(!0,{left:u})}}]),Spotlight}(y);var S=null;var D=function(){function SearchItem(r){var u,p;spotlight_classCallCheck(this,SearchItem),S||function loadBasicLocalizations(){S={MACRO:game.i18n.localize("DOCUMENT.Macro"),JOURNAL_ENTRY:game.i18n.localize("DOCUMENT.JournalEntry"),ROLL_TABLE:game.i18n.localize("DOCUMENT.RollTable"),PLAYLIST:game.i18n.localize("DOCUMENT.Playlist"),SCENE:game.i18n.localize("DOCUMENT.Scene"),JOURNAL_ENTRY_PAGE:game.i18n.localize("DOCUMENT.JournalEntryPage")}}(),this.name=r.name,this.nameExtra=null!==(u=r.nameExtra)&&void 0!==u?u:"",this.description=r.description,this.type=r.type,this.isSpecialApp=this.type.includes("special-app"),this.data=r.data,this.img=r.img,this.dragData=r.dragData,this.actions=r.actions,(0,w.PL)("showImages")||(this.img=null),this.icon=Array.isArray(r.icon)?r.icon:[r.icon],this.element=document.createElement("li"),this.element._searchItem=this,(p=this.element.classList).add.apply(p,["search-item"].concat(_toConsumableArray(this.type.split(" ")))),this.icon.length>1&&this.element.classList.add("multi-icons"),this.searchTerm=r,this.render(),this.addElementListeners()}return spotlight_createClass(SearchItem,[{key:"addElementListeners",value:function addElementListeners(){var r,u=this;(this.element.addEventListener("click",function(r){var p,y;if(u.isSpecialApp||updateRecent(u.name),ui.spotlightOmnisearch.isPrompt)return ui.spotlightOmnisearch.close({result:u.searchTerm});null===(p=(y=u.searchTerm).onClick)||void 0===p||p.call(y,r,u.searchTerm)}),this.setDraggable(),(0,w.PL)("appData").timer&&this.type.includes("timer"))&&(r=setInterval(function(){document.body.contains(u.element)?(u.name=u.searchTerm.name,u.render()):clearInterval(r)},1e3))}},{key:"render",value:function render(){var r,u,p=this.icon.map(function(r){return'<i class="'.concat(r,'"></i>')}).join("");this.element.innerHTML="".concat(this.img?'<img src="'.concat(this.img,'" alt="').concat(this.name,'">'):""," ").concat(p,' <div class="search-info"><span class="search-entry-name">').concat(this.name+this.nameExtra,"</span>").concat(this.description?"<p>".concat(this.description,"</p>"):"","</div>");var y=this.getActions();if(y){var h,v=null===(h=this.data)||void 0===h||null===(h=h.documentName)||void 0===h?void 0:h.includes("Journal"),b=document.createElement("div");y.actions.length<=3&&!v&&b.classList.add("search-entry-name-wrapper"),b.appendChild(this.element.querySelector(".search-entry-name")),this.element.querySelector(".search-info").insertAdjacentElement("afterbegin",b),b.appendChild(y.actionsContainer)}var w=this.element.querySelector(".s-toggle-setting");w&&w.addEventListener("click",function(r){r.preventDefault(),r.stopPropagation();var u=game.settings.get(w.dataset.namespace,w.dataset.key);game.settings.set(w.dataset.namespace,w.dataset.key,!u),w.classList.remove("fa-toggle-on","fa-toggle-off"),w.classList.add("fa-toggle-".concat(u?"off":"on"))}),null===(r=(u=this.searchTerm).activateListeners)||void 0===r||r.call(u,this.element)}},{key:"getActions",value:function getActions(){var r,u,p,y,h,v,b,w,k,E=this,O=null!==(r=_toConsumableArray(this.actions))&&void 0!==r?r:[],P=null===(u=this.data.uuid)||void 0===u?void 0:u.includes("Compendium");if(this.type.includes(S.MACRO))O.push({name:"".concat(I,".actions.execute"),icon:'<i class="fas fa-terminal"></i>',callback:(k=spotlight_asyncToGenerator(spotlight_regeneratorRuntime().mark(function _callee5(){return spotlight_regeneratorRuntime().wrap(function _callee5$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fromUuid(E.data.uuid);case 2:r.sent.execute();case 3:case"end":return r.stop()}},_callee5)})),function callback(){return k.apply(this,arguments)})});else if(this.type!=S.SCENE||P){if(this.type.includes(S.ROLL_TABLE))O.push({name:"".concat(I,".actions.roll-table"),icon:'<i class="fas fa-dice-d20"></i>',callback:(h=spotlight_asyncToGenerator(spotlight_regeneratorRuntime().mark(function _callee9(){return spotlight_regeneratorRuntime().wrap(function _callee9$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fromUuid(E.data.uuid);case 2:r.sent.draw();case 3:case"end":return r.stop()}},_callee9)})),function callback(){return h.apply(this,arguments)})});else if(this.type.includes(S.PLAYLIST)){var T=fromUuidSync(this.data.uuid);T&&!P&&(T.playing?O.push({name:"".concat(I,".actions.stop-playlist"),icon:'<i class="fas fa-stop"></i>',callback:(y=spotlight_asyncToGenerator(spotlight_regeneratorRuntime().mark(function _callee0(){return spotlight_regeneratorRuntime().wrap(function _callee0$(r){for(;;)switch(r.prev=r.next){case 0:T.stopAll();case 1:case"end":return r.stop()}},_callee0)})),function callback(){return y.apply(this,arguments)})}):O.push({name:"".concat(I,".actions.play-playlist"),icon:'<i class="fas fa-play"></i>',callback:(p=spotlight_asyncToGenerator(spotlight_regeneratorRuntime().mark(function _callee1(){return spotlight_regeneratorRuntime().wrap(function _callee1$(r){for(;;)switch(r.prev=r.next){case 0:T.playAll();case 1:case"end":return r.stop()}},_callee1)})),function callback(){return p.apply(this,arguments)})}))}else if(this.type.includes(S.JOURNAL_ENTRY)||this.type.includes(S.JOURNAL_ENTRY_PAGE)){var D=this.searchTerm.query.toLowerCase(),A=O.filter(function(r){return r.name.toLowerCase().includes(D)});A.length&&(O.length=0,O.push.apply(O,_toConsumableArray(A)))}}else O.push({name:"".concat(I,".actions.view"),icon:'<i class="fas fa-eye"></i>',callback:(w=spotlight_asyncToGenerator(spotlight_regeneratorRuntime().mark(function _callee6(){return spotlight_regeneratorRuntime().wrap(function _callee6$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fromUuid(E.data.uuid);case 2:r.sent.view();case 3:case"end":return r.stop()}},_callee6)})),function callback(){return w.apply(this,arguments)})},{name:"".concat(I,".actions.activate"),icon:'<i class="fas fa-play"></i>',callback:(b=spotlight_asyncToGenerator(spotlight_regeneratorRuntime().mark(function _callee7(){return spotlight_regeneratorRuntime().wrap(function _callee7$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fromUuid(E.data.uuid);case 2:r.sent.activate();case 3:case"end":return r.stop()}},_callee7)})),function callback(){return b.apply(this,arguments)})},{name:"".concat(I,".actions.preload"),icon:'<i class="fas fa-download"></i>',callback:(v=spotlight_asyncToGenerator(spotlight_regeneratorRuntime().mark(function _callee8(){var r;return spotlight_regeneratorRuntime().wrap(function _callee8$(u){for(;;)switch(u.prev=u.next){case 0:r=fromUuidSync(E.data.uuid),game.scenes.preload(r.id,!0);case 2:case"end":return u.stop()}},_callee8)})),function callback(){return v.apply(this,arguments)})});if(!O.length)return null;var x=document.createElement("div");return x.classList.add("search-item-actions"),O.forEach(function(r){var u=document.createElement("button");u.innerHTML=r.icon+" "+game.i18n.localize(r.name),u.addEventListener("click",function(u){E.isSpecialApp||updateRecent(E.name),u.preventDefault(),u.stopPropagation(),r.callback(u)}),x.appendChild(u)}),{actionsContainer:x,actions:O}}},{key:"setDragging",value:function setDragging(r){var u,p;null===(u=(p=this.searchTerm).onDragStart)||void 0===u||u.call(p,r),setTimeout(function(){document.querySelector("#spotlight").classList.add("dragging")},1)}},{key:"endDragging",value:function endDragging(r){var u,p;document.querySelector("#spotlight").classList.remove("dragging"),null===(u=(p=this.searchTerm).onDragEnd)||void 0===u||u.call(p,r)}},{key:"setDraggable",value:function setDraggable(){var r=this;this.data.uuid&&(this.element.setAttribute("draggable",!0),this.element.addEventListener("dragstart",function(u){r.setDragging(u),u.dataTransfer.setData("text/plain",JSON.stringify({type:r.data.documentName,uuid:r.data.uuid}))}),this.element.addEventListener("dragend",function(u){r.endDragging(u)})),this.dragData&&(this.element.setAttribute("draggable",!0),this.element.addEventListener("dragstart",function(u){r.setDragging(u),u.dataTransfer.setData("text/plain",JSON.stringify(r.dragData))}),this.element.addEventListener("dragend",function(u){r.endDragging(u)}),this.element.addEventListener("drop",function(u){var p,y;null===(p=(y=r.searchTerm).onDrop)||void 0===p||p.call(y,u)}))}}]),SearchItem}();function updateRecent(r){var u;if((0,w.PL)("useHistory")){var p=null!==(u=(0,w.PL)("recent"))&&void 0!==u?u:[];if(!p.includes(r))return p.unshift(r),p.length>50&&p.pop(),(0,w.ZC)("recent",p)}}var A=p(150);function main_typeof(r){return main_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},main_typeof(r)}function main_regeneratorRuntime(){var r=main_regenerator(),u=r.m(main_regeneratorRuntime),p=(Object.getPrototypeOf?Object.getPrototypeOf(u):u.__proto__).constructor;function n(r){var u="function"==typeof r&&r.constructor;return!!u&&(u===p||"GeneratorFunction"===(u.displayName||u.name))}var y={throw:1,return:2,break:3,continue:3};function a(r){var u,p;return function(h){u||(u={stop:function stop(){return p(h.a,2)},catch:function _catch(){return h.v},abrupt:function abrupt(r,u){return p(h.a,y[r],u)},delegateYield:function delegateYield(r,y,v){return u.resultName=y,p(h.d,main_regeneratorValues(r),v)},finish:function finish(r){return p(h.f,r)}},p=function t(r,p,y){h.p=u.prev,h.n=u.next;try{return r(p,y)}finally{u.next=h.n}}),u.resultName&&(u[u.resultName]=h.v,u.resultName=void 0),u.sent=h.v,u.next=h.n;try{return r.call(this,u)}finally{h.p=u.prev,h.n=u.next}}}return(main_regeneratorRuntime=function _regeneratorRuntime(){return{wrap:function wrap(u,p,y,h){return r.w(a(u),p,y,h&&h.reverse())},isGeneratorFunction:n,mark:r.m,awrap:function awrap(r,u){return new main_OverloadYield(r,u)},AsyncIterator:main_regeneratorAsyncIterator,async:function async(r,u,p,y,h){return(n(u)?main_regeneratorAsyncGen:main_regeneratorAsync)(a(r),u,p,y,h)},keys:main_regeneratorKeys,values:main_regeneratorValues}})()}function main_regeneratorValues(r){if(null!=r){var u=r["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],p=0;if(u)return u.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length))return{next:function next(){return r&&p>=r.length&&(r=void 0),{value:r&&r[p++],done:!r}}}}throw new TypeError(main_typeof(r)+" is not iterable")}function main_regeneratorKeys(r){var u=Object(r),p=[];for(var y in u)p.unshift(y);return function e(){for(;p.length;)if((y=p.pop())in u)return e.value=y,e.done=!1,e;return e.done=!0,e}}function main_regeneratorAsync(r,u,p,y,h){var v=main_regeneratorAsyncGen(r,u,p,y,h);return v.next().then(function(r){return r.done?r.value:v.next()})}function main_regeneratorAsyncGen(r,u,p,y,h){return new main_regeneratorAsyncIterator(main_regenerator().w(r,u,p,y),h||Promise)}function main_regeneratorAsyncIterator(r,u){function n(p,y,h,v){try{var b=r[p](y),w=b.value;return w instanceof main_OverloadYield?u.resolve(w.v).then(function(r){n("next",r,h,v)},function(r){n("throw",r,h,v)}):u.resolve(w).then(function(r){b.value=r,h(b)},function(r){return n("throw",r,h,v)})}catch(r){v(r)}}var p;this.next||(main_regeneratorDefine2(main_regeneratorAsyncIterator.prototype),main_regeneratorDefine2(main_regeneratorAsyncIterator.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),main_regeneratorDefine2(this,"_invoke",function(r,y,h){function f(){return new u(function(u,p){n(r,h,u,p)})}return p=p?p.then(f,f):f()},!0)}function main_regenerator(){var r,u,p="function"==typeof Symbol?Symbol:{},y=p.iterator||"@@iterator",h=p.toStringTag||"@@toStringTag";function i(p,y,h,b){var w=y&&y.prototype instanceof Generator?y:Generator,k=Object.create(w.prototype);return main_regeneratorDefine2(k,"_invoke",function(p,y,h){var b,w,k,E=0,O=h||[],P=!1,T={p:0,n:0,v:r,a:d,f:d.bind(r,4),d:function d(u,p){return b=u,w=0,k=r,T.n=p,v}};function d(p,y){for(w=p,k=y,u=0;!P&&E&&!h&&u<O.length;u++){var h,b=O[u],S=T.p,D=b[2];p>3?(h=D===y)&&(k=b[(w=b[4])?5:(w=3,3)],b[4]=b[5]=r):b[0]<=S&&((h=p<2&&S<b[1])?(w=0,T.v=y,T.n=b[1]):S<D&&(h=p<3||b[0]>y||y>D)&&(b[4]=p,b[5]=y,T.n=D,w=0))}if(h||p>1)return v;throw P=!0,y}return function(h,O,S){if(E>1)throw TypeError("Generator is already running");for(P&&1===O&&d(O,S),w=O,k=S;(u=w<2?r:k)||!P;){b||(w?w<3?(w>1&&(T.n=-1),d(w,k)):T.n=k:T.v=k);try{if(E=2,b){if(w||(h="next"),u=b[h]){if(!(u=u.call(b,k)))throw TypeError("iterator result is not an object");if(!u.done)return u;k=u.value,w<2&&(w=0)}else 1===w&&(u=b.return)&&u.call(b),w<2&&(k=TypeError("The iterator does not provide a '"+h+"' method"),w=1);b=r}else if((u=(P=T.n<0)?k:p.call(y,T))!==v)break}catch(u){b=r,w=1,k=u}finally{E=1}}return{value:u,done:P}}}(p,h,b),!0),k}var v={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}u=Object.getPrototypeOf;var b=[][y]?u(u([][y]())):(main_regeneratorDefine2(u={},y,function(){return this}),u),w=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(b);function f(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,GeneratorFunctionPrototype):(r.__proto__=GeneratorFunctionPrototype,main_regeneratorDefine2(r,h,"GeneratorFunction")),r.prototype=Object.create(w),r}return GeneratorFunction.prototype=GeneratorFunctionPrototype,main_regeneratorDefine2(w,"constructor",GeneratorFunctionPrototype),main_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",main_regeneratorDefine2(GeneratorFunctionPrototype,h,"GeneratorFunction"),main_regeneratorDefine2(w),main_regeneratorDefine2(w,h,"Generator"),main_regeneratorDefine2(w,y,function(){return this}),main_regeneratorDefine2(w,"toString",function(){return"[object Generator]"}),(main_regenerator=function _regenerator(){return{w:i,m:f}})()}function main_regeneratorDefine2(r,u,p,y){var h=Object.defineProperty;try{h({},"",{})}catch(r){h=0}main_regeneratorDefine2=function _regeneratorDefine(r,u,p,y){function o(u,p){main_regeneratorDefine2(r,u,function(r){return this._invoke(u,p,r)})}u?h?h(r,u,{value:p,enumerable:!y,configurable:!y,writable:!y}):r[u]=p:(o("next",0),o("throw",1),o("return",2))},main_regeneratorDefine2(r,u,p,y)}function main_OverloadYield(r,u){this.v=r,this.k=u}function main_toConsumableArray(r){return function main_arrayWithoutHoles(r){if(Array.isArray(r))return main_arrayLikeToArray(r)}(r)||function main_iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||function main_unsupportedIterableToArray(r,u){if(r){if("string"==typeof r)return main_arrayLikeToArray(r,u);var p={}.toString.call(r).slice(8,-1);return"Object"===p&&r.constructor&&(p=r.constructor.name),"Map"===p||"Set"===p?Array.from(r):"Arguments"===p||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p)?main_arrayLikeToArray(r,u):void 0}}(r)||function main_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function main_arrayLikeToArray(r,u){(null==u||u>r.length)&&(u=r.length);for(var p=0,y=Array(u);p<u;p++)y[p]=r[p];return y}function main_asyncGeneratorStep(r,u,p,y,h,v,b){try{var w=r[v](b),k=w.value}catch(r){return void p(r)}w.done?u(k):Promise.resolve(k).then(y,h)}var I="spotlight-omnisearch";Hooks.on("init",function(){var r;(0,w.Nq)(),h.register(),CONFIG.SpotlightOmnisearch={app:T,INDEX:b.hx,SearchTerm:k.g,rebuildIndex:function rebuildIndex(){return(0,b.Xh)(!0)},prompt:(r=function main_asyncToGenerator(r){return function(){var u=this,p=arguments;return new Promise(function(y,h){var v=r.apply(u,p);function _next(r){main_asyncGeneratorStep(v,y,h,_next,_throw,"next",r)}function _throw(r){main_asyncGeneratorStep(v,y,h,_next,_throw,"throw",r)}_next(void 0)})}}(main_regeneratorRuntime().mark(function _callee(){var r,u,p,y=arguments;return main_regeneratorRuntime().wrap(function _callee$(h){for(;;)switch(h.prev=h.next){case 0:if(r=y.length>0&&void 0!==y[0]?y[0]:{query:""},game.user.isGM||!(0,w.PL)("gmOnly")){h.next=3;break}return h.abrupt("return",null);case 3:return(u=main_toConsumableArray(foundry.applications.instances.values()).find(function(r){return r instanceof T}))&&u.close(),(p=new T({promptOptions:r,isPrompt:!0})).render(!0),h.abrupt("return",p.promise);case 8:case"end":return h.stop()}},_callee)})),function prompt(){return r.apply(this,arguments)})},Object.defineProperty(CONFIG,"SpotlightOmniseach",{get:function get(){return console.warn("The CONFIG.SpotlightOmniseach contained a typo, please update your modules to use the correct spelling by using CONFIG.SpotlightOmnisearch. This will be removed in version 1.0.0."),CONFIG.SpotlightOmnisearch}})}),Hooks.once("canvasReady",function(){(0,w.PL)("firstTime")&&(setTimeout(function(){!game.user.isGM&&(0,w.PL)("gmOnly")||new T({first:!0}).render(!0)},1e3),(0,w.ZC)("firstTime",!1))}),Hooks.on("ready",function(){(0,w.PL)("enableCtrlSpace")&&document.addEventListener("keydown",function(r){if(r.ctrlKey&&" "===r.key){if(!game.user.isGM&&(0,w.PL)("gmOnly"))return;var u=main_toConsumableArray(foundry.applications.instances.values()).find(function(r){return r instanceof T});u?u.close():(new T).render(!0)}}),(0,A.u)()}),Hooks.on("init",function(){game.keybindings.register(I,"toggleSpotlight",{name:"".concat(I,".hotkeys.toggleSpotlight.name"),editable:[{key:"Space",modifiers:["Shift"]}],restricted:!1,precedence:CONST.KEYBINDING_PRECEDENCE.PRIORITY,onDown:function onDown(r){if(game.user.isGM||!(0,w.PL)("gmOnly")){var u=main_toConsumableArray(foundry.applications.instances.values()).find(function(r){return r instanceof T});u?u.close():(new T).render(!0)}}})})},508(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{R:()=>SPECIAL_SEARCHES,g:()=>initSpecialSearches});var _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(636),_main__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(208),_settings__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(786),_buildTermIndex__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(717);function _defineProperty(r,u,p){return(u=_toPropertyKey(u))in r?Object.defineProperty(r,u,{value:p,enumerable:!0,configurable:!0,writable:!0}):r[u]=p,r}function _toPropertyKey(r){var u=_toPrimitive(r,"string");return"symbol"==_typeof(u)?u:u+""}function _toPrimitive(r,u){if("object"!=_typeof(r)||!r)return r;var p=r[Symbol.toPrimitive];if(void 0!==p){var y=p.call(r,u||"default");if("object"!=_typeof(y))return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===u?String:Number)(r)}function _typeof(r){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_typeof(r)}function _regeneratorRuntime(){var r=_regenerator(),u=r.m(_regeneratorRuntime),p=(Object.getPrototypeOf?Object.getPrototypeOf(u):u.__proto__).constructor;function n(r){var u="function"==typeof r&&r.constructor;return!!u&&(u===p||"GeneratorFunction"===(u.displayName||u.name))}var y={throw:1,return:2,break:3,continue:3};function a(r){var u,p;return function(h){u||(u={stop:function stop(){return p(h.a,2)},catch:function _catch(){return h.v},abrupt:function abrupt(r,u){return p(h.a,y[r],u)},delegateYield:function delegateYield(r,y,v){return u.resultName=y,p(h.d,_regeneratorValues(r),v)},finish:function finish(r){return p(h.f,r)}},p=function t(r,p,y){h.p=u.prev,h.n=u.next;try{return r(p,y)}finally{u.next=h.n}}),u.resultName&&(u[u.resultName]=h.v,u.resultName=void 0),u.sent=h.v,u.next=h.n;try{return r.call(this,u)}finally{h.p=u.prev,h.n=u.next}}}return(_regeneratorRuntime=function _regeneratorRuntime(){return{wrap:function wrap(u,p,y,h){return r.w(a(u),p,y,h&&h.reverse())},isGeneratorFunction:n,mark:r.m,awrap:function awrap(r,u){return new _OverloadYield(r,u)},AsyncIterator:_regeneratorAsyncIterator,async:function async(r,u,p,y,h){return(n(u)?_regeneratorAsyncGen:_regeneratorAsync)(a(r),u,p,y,h)},keys:_regeneratorKeys,values:_regeneratorValues}})()}function _regeneratorValues(r){if(null!=r){var u=r["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],p=0;if(u)return u.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length))return{next:function next(){return r&&p>=r.length&&(r=void 0),{value:r&&r[p++],done:!r}}}}throw new TypeError(_typeof(r)+" is not iterable")}function _regeneratorKeys(r){var u=Object(r),p=[];for(var y in u)p.unshift(y);return function e(){for(;p.length;)if((y=p.pop())in u)return e.value=y,e.done=!1,e;return e.done=!0,e}}function _regeneratorAsync(r,u,p,y,h){var v=_regeneratorAsyncGen(r,u,p,y,h);return v.next().then(function(r){return r.done?r.value:v.next()})}function _regeneratorAsyncGen(r,u,p,y,h){return new _regeneratorAsyncIterator(_regenerator().w(r,u,p,y),h||Promise)}function _regeneratorAsyncIterator(r,u){function n(p,y,h,v){try{var b=r[p](y),w=b.value;return w instanceof _OverloadYield?u.resolve(w.v).then(function(r){n("next",r,h,v)},function(r){n("throw",r,h,v)}):u.resolve(w).then(function(r){b.value=r,h(b)},function(r){return n("throw",r,h,v)})}catch(r){v(r)}}var p;this.next||(_regeneratorDefine2(_regeneratorAsyncIterator.prototype),_regeneratorDefine2(_regeneratorAsyncIterator.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),_regeneratorDefine2(this,"_invoke",function(r,y,h){function f(){return new u(function(u,p){n(r,h,u,p)})}return p=p?p.then(f,f):f()},!0)}function _regenerator(){var r,u,p="function"==typeof Symbol?Symbol:{},y=p.iterator||"@@iterator",h=p.toStringTag||"@@toStringTag";function i(p,y,h,b){var w=y&&y.prototype instanceof Generator?y:Generator,k=Object.create(w.prototype);return _regeneratorDefine2(k,"_invoke",function(p,y,h){var b,w,k,E=0,O=h||[],P=!1,T={p:0,n:0,v:r,a:d,f:d.bind(r,4),d:function d(u,p){return b=u,w=0,k=r,T.n=p,v}};function d(p,y){for(w=p,k=y,u=0;!P&&E&&!h&&u<O.length;u++){var h,b=O[u],S=T.p,D=b[2];p>3?(h=D===y)&&(k=b[(w=b[4])?5:(w=3,3)],b[4]=b[5]=r):b[0]<=S&&((h=p<2&&S<b[1])?(w=0,T.v=y,T.n=b[1]):S<D&&(h=p<3||b[0]>y||y>D)&&(b[4]=p,b[5]=y,T.n=D,w=0))}if(h||p>1)return v;throw P=!0,y}return function(h,O,S){if(E>1)throw TypeError("Generator is already running");for(P&&1===O&&d(O,S),w=O,k=S;(u=w<2?r:k)||!P;){b||(w?w<3?(w>1&&(T.n=-1),d(w,k)):T.n=k:T.v=k);try{if(E=2,b){if(w||(h="next"),u=b[h]){if(!(u=u.call(b,k)))throw TypeError("iterator result is not an object");if(!u.done)return u;k=u.value,w<2&&(w=0)}else 1===w&&(u=b.return)&&u.call(b),w<2&&(k=TypeError("The iterator does not provide a '"+h+"' method"),w=1);b=r}else if((u=(P=T.n<0)?k:p.call(y,T))!==v)break}catch(u){b=r,w=1,k=u}finally{E=1}}return{value:u,done:P}}}(p,h,b),!0),k}var v={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}u=Object.getPrototypeOf;var b=[][y]?u(u([][y]())):(_regeneratorDefine2(u={},y,function(){return this}),u),w=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(b);function f(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,GeneratorFunctionPrototype):(r.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(r,h,"GeneratorFunction")),r.prototype=Object.create(w),r}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(w,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,h,"GeneratorFunction"),_regeneratorDefine2(w),_regeneratorDefine2(w,h,"Generator"),_regeneratorDefine2(w,y,function(){return this}),_regeneratorDefine2(w,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(r,u,p,y){var h=Object.defineProperty;try{h({},"",{})}catch(r){h=0}_regeneratorDefine2=function _regeneratorDefine(r,u,p,y){function o(u,p){_regeneratorDefine2(r,u,function(r){return this._invoke(u,p,r)})}u?h?h(r,u,{value:p,enumerable:!y,configurable:!y,writable:!y}):r[u]=p:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(r,u,p,y)}function _OverloadYield(r,u){this.v=r,this.k=u}function asyncGeneratorStep(r,u,p,y,h,v,b){try{var w=r[v](b),k=w.value}catch(r){return void p(r)}w.done?u(k):Promise.resolve(k).then(y,h)}function _asyncToGenerator(r){return function(){var u=this,p=arguments;return new Promise(function(y,h){var v=r.apply(u,p);function _next(r){asyncGeneratorStep(v,y,h,_next,_throw,"next",r)}function _throw(r){asyncGeneratorStep(v,y,h,_next,_throw,"throw",r)}_next(void 0)})}}var SPECIAL_SEARCHES=[],LAST_COUNTER_FOCUS=null;function initSpecialSearches(){return _initSpecialSearches.apply(this,arguments)}function _initSpecialSearches(){return _initSpecialSearches=_asyncToGenerator(_regeneratorRuntime().mark(function _callee28(){var _game$modules$get,NOTE_MATCHING,ROLL_MATCHING,TIMER_MATCHING,TRACKER_MATCHING,COUNTER_MATCHING,UNITS_MAPPING,UNITS,LIGHT_LOCALIZATION,parseTime,useMetricForLights,conversionRatio,lightEffects,getSplatterData;return _regeneratorRuntime().wrap(function _callee28$(_context28){for(;;)switch(_context28.prev=_context28.next){case 0:parseTime=function _parseTime3(r){var u=0,p=0,y=0,h=/(\d+)[\s:]+(\d+)[\s:]+(\d+)/,v=/(\d+)[\s:]+(\d+)/,b=/(\d+)\s*m/,w=/(\d+)\s*s/;if(h.test(r)){var k=r.match(h);u=parseInt(k[1]),p=parseInt(k[2]),y=parseInt(k[3])}else if(v.test(r)){var E=r.match(v);p=parseInt(E[1]),y=parseInt(E[2])}else if(b.test(r)){var O=r.match(b);p=parseInt(O[1])}else{if(!w.test(r)){var P=parseInt(r);return isNaN(P)||(y=P),{hours:u,minutes:p,seconds:y}}var T=r.match(w);y=parseInt(T[1])}return{hours:u,minutes:p,seconds:y}},SPECIAL_SEARCHES.length=0,NOTE_MATCHING=["notes","note:","notes:","n:","n ",game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.note.local-keyword"))],ROLL_MATCHING=["!roll","roll:","r:","r ",game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.roll.local-keyword"))],TIMER_MATCHING=["timer:","time","time:","t:","t ",game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.timer.local-keyword"))],TRACKER_MATCHING=["tracker:","t:","t ","track","track:","s:","s ","f:","f ",game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.tracker.local-keyword"))],COUNTER_MATCHING=["counter:","c:","c ","count","count:","c:","c ",game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.counter.local-keyword"))],UNITS_MAPPING={ft:function ft(r){return.3048*r+"m"},in:function _in(r){return 2.54*r+"cm"},yd:function yd(r){return.9144*r+"m"},mi:function mi(r){return 1.60934*r+"km"},lb:function lb(r){return.453592*r+"kg"},lbs:function lbs(r){return.453592*r+"kg"},oz:function oz(r){return 28.3495*r+"g"},gal:function gal(r){return 3.78541*r+"l"},pt:function pt(r){return 473.176*r+"ml"},"fl oz":function flOz(r){return 29.5735*r+"ml"},tbsp:function tbsp(r){return 14.7868*r+"ml"},f:function f(r){return 5*(r-32)/9+"c"},"°":function _(r){return 9*r/5+32+"f"},"°C":function C(r){return 9*r/5+32+"°F"},"°F":function F(r){return 5*(r-32)/9+"°C"},c:function c(r){return 9*r/5+32+"f"},m:function m(r){return 3.28084*r+"ft"},cm:function cm(r){return.393701*r+"in"},km:function km(r){return.621371*r+"mi"},kg:function kg(r){return 2.20462*r+"lb"},g:function g(r){return.035274*r+"oz"},l:function l(r){return.264172*r+"gal"},ml:function ml(r){return.00211338*r+"pt"}},UNITS=Object.keys(UNITS_MAPPING),LIGHT_LOCALIZATION=game.i18n.localize("Light"),SPECIAL_SEARCHES.push(new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(search){try{return"".concat(eval(search.query))}catch(_unused){for(var query=search.query;query.length>0&&isNaN(query[query.length-1]);)query=query.slice(0,-1);try{return"".concat(eval(query))}catch(r){return"..."}}},type:"special-app",data:{},img:"",icon:"fad fa-calculator",match:function match(r){return r&&r.match(/^[0-9\+\-\*\/\(\)\.\s]*$/)},onClick:function onClick(r){navigator.clipboard.writeText(this.name),ui.notifications.info(game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".notifications.calc-clipboard")))}}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(r){var u,p,y,h=r.query.replaceAll(" ",""),v=null===(u=h.match(/[\d+-.]+/))||void 0===u?void 0:u[0],b=null===(p=h.match(/[a-zA-Z°]+/))||void 0===p?void 0:p[0],w=null!==(y=UNITS.find(function(r){return b===r}))&&void 0!==y?y:UNITS.find(function(r){return b.includes(r)});if(v&&w){var k,E,O=parseFloat(v),P=w,T=UNITS_MAPPING[P](O),S=null===(k=T.match(/[\d+-.]+/))||void 0===k?void 0:k[0],D=null===(E=T.match(/[a-zA-Z°]+/))||void 0===E?void 0:E[0];return S&&(S=parseFloat(S).toFixed(2)),'<div class="unit-converter-result"><span>'.concat(O," ").concat(P,'</span> <i class="fas fa-equals"></i> <span data-converted="').concat(S,'">').concat(S," ").concat(D,"</span></div>")}return"..."},type:"special-app",data:{},img:"",icon:"fad fa-calculator",match:function match(r){var u,p,y=null===(u=(r=r.replaceAll(" ","")).match(/[\d.]+/))||void 0===u?void 0:u[0],h=null===(p=r.match(/[a-zA-Z°]+/))||void 0===p?void 0:p[0];return y&&UNITS.includes(h)},onClick:function onClick(r,u){var p=document.createElement("div");p.innerHTML=u.name;var y=p.querySelector("span[data-converted]").dataset.converted;navigator.clipboard.writeText(y),ui.notifications.info(game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".notifications.calc-clipboard")))}}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.note.name"))},description:function description(r){return r.query.replace(/(note|notes|!note|!notes|note:|notes:|!n|n:)/i,"").trim()},type:"special-app",data:{},img:"",icon:"fad fa-sticky-note",match:function match(r){return NOTE_MATCHING.some(function(u){return r.startsWith(u)})},onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee(r){var u,p,y,h,v,b,w,k;return _regeneratorRuntime().wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:if(p=this.description){r.next=3;break}return r.abrupt("return");case 3:if(y="Omnisearch Notes [".concat(game.user.name,"]"),h=game.journal.getName(y)){r.next=9;break}return r.next=8,JournalEntry.create({name:y});case 8:h=r.sent;case 9:if(v=(new Date).toLocaleDateString(),b=(new Date).toLocaleTimeString(),w=h.pages.getName(v)){r.next=17;break}return r.next=15,h.createEmbeddedDocuments("JournalEntryPage",[{name:v,type:"text"}]);case 15:w=(w=r.sent)[0];case 17:k=null!==(u=w.text.content)&&void 0!==u?u:"",w.update({"text.content":"".concat(k," <h3>").concat(b,":</h3><p>").concat(p,"</p>")}),ui.notifications.info(game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".notifications.note")));case 20:case"end":return r.stop()}},_callee,this)}));return function onClick(u){return r.apply(this,arguments)}}()}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.roll.name"))},description:function description(r){return r.query.replace(/(roll|!roll|roll:|!r|r:|r )/i,"").trim()},type:"special-app",data:{},img:"",icon:"fad fa-dice-d20",match:function match(r){return ROLL_MATCHING.some(function(u){return r.startsWith(u)})},onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee2(r){return _regeneratorRuntime().wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:new Roll(this.description).toMessage();case 1:case"end":return r.stop()}},_callee2,this)}));return function onClick(u){return r.apply(this,arguments)}}()}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.help.name"))},description:function description(r){var u=game.i18n.translations["spotlight-omnisearch"].special.help.list,p="<ul>".concat(u.map(function(r){return'<li style="pointer-events:none">'.concat(r,"</li>")}).join(""),"</ul>"),y=_buildTermIndex__WEBPACK_IMPORTED_MODULE_3__.SC.map(function(r){return'<span class="filter" data-filter="'.concat(r,'">').concat(r,"</span>")}).join("");return"".concat(p,' <div class="filters-help">').concat(y,"</div>")},type:"special-app help",data:{},img:"",icon:"fad fa-question",match:function match(r){return r.includes("help")||r.startsWith("?")},onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee3(r){return _regeneratorRuntime().wrap(function _callee3$(r){for(;;)switch(r.prev=r.next){case 0:case"end":return r.stop()}},_callee3)}));return function onClick(u){return r.apply(this,arguments)}}()}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(){var r=game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.timer.name")),u=(0,_settings__WEBPACK_IMPORTED_MODULE_2__.PL)("appData").timer;if(u){var p=u-Date.now();if(p>0){var y=Math.floor(p/36e5),h=Math.floor(p%36e5/6e4),v=Math.floor(p%6e4/1e3);v<10&&(v="0".concat(v)),r+='<hr><strong style="font-size: larger;">'.concat(y?"".concat(y,":"):"").concat(h?"".concat(h,":"):"").concat(v?"".concat(v):"","</strong>")}}else if(void 0!==u&&game.user.isGM){var b=(0,_settings__WEBPACK_IMPORTED_MODULE_2__.PL)("appData");delete b.timer,(0,_settings__WEBPACK_IMPORTED_MODULE_2__.ZC)("appData",b)}return r},description:function description(r){var u=r.query.replace(/(timer|timer:|time|time:|t:|t )/i,"").trim(),p=parseTime(u),y=p.hours,h=p.minutes,v=p.seconds;return"".concat(y?"".concat(y,"h "):"").concat(h?"".concat(h,"m "):"").concat(v?"".concat(v,"s"):"")},type:"special-app timer",data:{},img:"",icon:"fad fa-stopwatch",match:function match(r){return TIMER_MATCHING.some(function(u){return r.startsWith(u)})},onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee4(r){var u,p,y,h,v,b,w,k,E,O;return _regeneratorRuntime().wrap(function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:if(game.user.isGM){r.next=2;break}return r.abrupt("return",ui.notifications.error(game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".notifications.timer-gm"))));case 2:if(p=this.query.replace(/(timer|timer:|time|time:|t:|t )/i,"").trim(),y=parseTime(p),h=y.hours,v=y.minutes,b=y.seconds,!((w=3600*h+60*v+b)<=0)){r.next=7;break}return r.abrupt("return");case 7:return k=Date.now(),E=k+1e3*w,(O=(0,_settings__WEBPACK_IMPORTED_MODULE_2__.PL)("appData")).timer=E,r.next=13,(0,_settings__WEBPACK_IMPORTED_MODULE_2__.ZC)("appData",O);case 13:null===(u=ui.spotlightOmnisearch)||void 0===u||u._onSearch();case 14:case"end":return r.stop()}},_callee4,this)}));return function onClick(u){return r.apply(this,arguments)}}()}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.tracker.name"))},type:"special-app",data:{},img:"",icon:"fad fa-check-circle",match:function match(r){return TRACKER_MATCHING.some(function(u){return r.startsWith(u)})},onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee5(r){return _regeneratorRuntime().wrap(function _callee5$(r){for(;;)switch(r.prev=r.next){case 0:case"end":return r.stop()}},_callee5)}));return function onClick(u){return r.apply(this,arguments)}}(),activateListeners:function activateListeners(r){var u=(0,_settings__WEBPACK_IMPORTED_MODULE_2__.PL)("appData");u.tracker||(u.tracker={success:2,fail:3});var p=u.tracker.success,y=u.tracker.fail,h=document.createElement("div");h.classList.add("tracker-container");for(var v=[],b=function _loop(r){var y=document.createElement("div");y.classList.add("tracker-dot","success"),r<p&&y.classList.add("checked"),v.push(y),y.addEventListener("click",_asyncToGenerator(_regeneratorRuntime().mark(function _callee6(){var h;return _regeneratorRuntime().wrap(function _callee6$(b){for(;;)switch(b.prev=b.next){case 0:if(game.user.isGM){b.next=2;break}return b.abrupt("return",ui.notifications.error(game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".notifications.tracker-gm"))));case 2:if(y.classList.contains("checked")&&r===p-1)y.classList.remove("checked"),u.tracker.success--,p--;else{for(v.forEach(function(r){return r.classList.remove("checked")}),h=0;h<=r;h++)v[h].classList.add("checked");u.tracker.success=r+1,p=r+1}return b.next=6,(0,_settings__WEBPACK_IMPORTED_MODULE_2__.ZC)("appData",u);case 6:case"end":return b.stop()}},_callee6)})))},w=0;w<7;w++)b(w);v.reverse().forEach(function(r){return h.appendChild(r)}),v.reverse();var k=document.createElement("div");k.classList.add("tracker-slash"),k.innerHTML='<i class="fa-sharp fa-solid fa-slash-forward"></i>',h.appendChild(k);for(var E=[],O=function _loop2(r){var p=document.createElement("div");p.classList.add("tracker-dot","fail"),r<y&&p.classList.add("checked"),h.appendChild(p),E.push(p),p.addEventListener("click",_asyncToGenerator(_regeneratorRuntime().mark(function _callee7(){var h;return _regeneratorRuntime().wrap(function _callee7$(v){for(;;)switch(v.prev=v.next){case 0:if(game.user.isGM){v.next=2;break}return v.abrupt("return",ui.notifications.error(game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".notifications.tracker-gm"))));case 2:if(p.classList.contains("checked")&&r===y-1)p.classList.remove("checked"),u.tracker.fail--,y--;else{for(E.forEach(function(r){return r.classList.remove("checked")}),h=0;h<=r;h++)E[h].classList.add("checked");u.tracker.fail=r+1,y=r+1}return v.next=6,(0,_settings__WEBPACK_IMPORTED_MODULE_2__.ZC)("appData",u);case 6:case"end":return v.stop()}},_callee7)})))},P=0;P<7;P++)O(P);r.querySelector(".search-info").appendChild(h)}}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.counter.name"))},type:"special-app",data:{},img:"",icon:"fad fa-plus-circle",match:function match(r){return COUNTER_MATCHING.some(function(u){return r.startsWith(u)})},onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee8(r){return _regeneratorRuntime().wrap(function _callee8$(r){for(;;)switch(r.prev=r.next){case 0:case"end":return r.stop()}},_callee8)}));return function onClick(u){return r.apply(this,arguments)}}(),activateListeners:function activateListeners(r){var u=(0,_settings__WEBPACK_IMPORTED_MODULE_2__.PL)("appData");u.counter||(u.counter=[0,0,0,0],(0,_settings__WEBPACK_IMPORTED_MODULE_2__.ZC)("appData",u));var p=[],y=document.createElement("div");y.classList.add("counter-container");for(var h=function _loop3(r){var y=document.createElement("input");y.type="number",y.value=u.counter[r]||0;var h=document.createElement("div");h.classList.add("counter-input-container"),h.appendChild(y);var v=document.createElement("div");v.classList.add("up-down-container");var b=document.createElement("i");b.classList.add("fas","fa-chevron-up"),b.addEventListener("click",_asyncToGenerator(_regeneratorRuntime().mark(function _callee9(){return _regeneratorRuntime().wrap(function _callee9$(p){for(;;)switch(p.prev=p.next){case 0:if(game.user.isGM){p.next=2;break}return p.abrupt("return",ui.notifications.error(game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".notifications.counter-gm"))));case 2:return y.value=parseInt(y.value)+1,u.counter[r]=y.value,p.next=6,(0,_settings__WEBPACK_IMPORTED_MODULE_2__.ZC)("appData",u);case 6:case"end":return p.stop()}},_callee9)}))),v.appendChild(b);var w=document.createElement("i");w.classList.add("fas","fa-chevron-down"),w.addEventListener("click",_asyncToGenerator(_regeneratorRuntime().mark(function _callee0(){return _regeneratorRuntime().wrap(function _callee0$(p){for(;;)switch(p.prev=p.next){case 0:if(game.user.isGM){p.next=2;break}return p.abrupt("return",ui.notifications.error(game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".notifications.counter-gm"))));case 2:return y.value=parseInt(y.value)-1,u.counter[r]=y.value,p.next=6,(0,_settings__WEBPACK_IMPORTED_MODULE_2__.ZC)("appData",u);case 6:case"end":return p.stop()}},_callee0)}))),v.appendChild(w),h.appendChild(v),p.push(h),y.addEventListener("keyup",_asyncToGenerator(_regeneratorRuntime().mark(function _callee1(){var p,h;return _regeneratorRuntime().wrap(function _callee1$(v){for(;;)switch(v.prev=v.next){case 0:if(game.user.isGM){v.next=2;break}return v.abrupt("return",ui.notifications.error(game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".notifications.counter-gm"))));case 2:return(h=(0,_settings__WEBPACK_IMPORTED_MODULE_2__.PL)("appData")).counter=null!==(p=h.counter)&&void 0!==p?p:[0,0,0,0],h.counter[r]=parseInt(y.value),LAST_COUNTER_FOCUS=r,v.next=8,(0,_settings__WEBPACK_IMPORTED_MODULE_2__.ZC)("appData",u);case 8:case"end":return v.stop()}},_callee1)})))},v=0;v<4;v++)h(v);p.forEach(function(r){return y.appendChild(r)}),r.querySelector(".search-info").appendChild(y)}}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(r){var u=r.query.replace(/(attr:|@)/i,"").trim();return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.attribute.name"))+": "+u},description:function description(r){var u=r.query.replace(/(attr:|@)/i,"").trim(),p=Array.from(new Set(game.users.map(function(r){return r.character}).concat(canvas.tokens.controlled.map(function(r){return r.actor})).filter(function(r){return r&&r.isOwner}))).sort(function(r,u){return r.name.localeCompare(u.name)}),y=document.createElement("div"),h=document.createElement("ul");return y.appendChild(h),p.forEach(function(r){var p=document.createElement("li"),y=u?foundry.utils.getProperty(r.system,u):foundry.utils.getProperty(r,"system");if(void 0===y){var v,b=u.split(".").slice(0,-1).join(".");y=b?null!==(v=foundry.utils.getProperty(r.system,b))&&void 0!==v?v:"?":foundry.utils.getProperty(r,"system")}y="object"===_typeof(y)?Object.keys(y).map(function(r){return"<strong>".concat(r,"</strong>")}).join(", "):"<strong>".concat(y,"</strong>"),p.innerHTML='<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 5px;width: 100%"><span>'.concat(r.name,"</span><span>").concat(y,"</span></div>"),h.appendChild(p)}),y.innerHTML},type:"special-app",data:{},img:"",icon:"fad fa-brackets-curly",match:function match(r){return r.startsWith("attr:")||r.startsWith("@")},onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee10(r){return _regeneratorRuntime().wrap(function _callee10$(r){for(;;)switch(r.prev=r.next){case 0:case"end":return r.stop()}},_callee10)}));return function onClick(u){return r.apply(this,arguments)}}()})),useMetricForLights=(0,_settings__WEBPACK_IMPORTED_MODULE_2__.PL)("useMetricForLights"),conversionRatio=useMetricForLights?.3048:1,lightEffects=[new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.light.torch"))},description:function description(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.light.info"))},img:"icons/sundries/lights/torch-black.webp",icon:["fas fa-fire-flame","fas fa-sun"],type:LIGHT_LOCALIZATION,onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee11(r){var u;return _regeneratorRuntime().wrap(function _callee11$(r){for(;;)switch(r.prev=r.next){case 0:u=canvas.tokens.controlled.map(function(r){return{_id:r.document.id,light:{alpha:.5,angle:360,bright:20*conversionRatio,coloration:1,dim:40*conversionRatio,luminosity:.5,saturation:0,contrast:0,shadows:0,animation:{speed:5,intensity:5,reverse:!1,type:"torch"},darkness:{min:0,max:1},color:"#fea50b",attenuation:.5}}}),canvas.scene.updateEmbeddedDocuments("Token",u);case 2:case"end":return r.stop()}},_callee11)}));return function onClick(u){return r.apply(this,arguments)}}()}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.light.candle"))},description:function description(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.light.info"))},img:"icons/sundries/lights/candle-lit-yellow.webp",icon:["fas fa-fire-flame","fas fa-sun"],type:LIGHT_LOCALIZATION,onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee12(r){var u;return _regeneratorRuntime().wrap(function _callee12$(r){for(;;)switch(r.prev=r.next){case 0:u=canvas.tokens.controlled.map(function(r){return{_id:r.document.id,light:{alpha:.5,angle:360,bright:5*conversionRatio,coloration:1,dim:10*conversionRatio,luminosity:.5,saturation:0,contrast:0,shadows:0,animation:{speed:5,intensity:5,reverse:!1,type:"torch"},darkness:{min:0,max:1},color:"#fea50b",attenuation:.5}}}),canvas.scene.updateEmbeddedDocuments("Token",u);case 2:case"end":return r.stop()}},_callee12)}));return function onClick(u){return r.apply(this,arguments)}}()}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.light.lantern"))},description:function description(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.light.info"))},img:"icons/sundries/lights/lantern-iron-yellow.webp",icon:["fas fa-fire-flame","fas fa-sun"],type:LIGHT_LOCALIZATION,onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee13(r){var u;return _regeneratorRuntime().wrap(function _callee13$(r){for(;;)switch(r.prev=r.next){case 0:u=canvas.tokens.controlled.map(function(r){return{_id:r.document.id,light:{alpha:.5,angle:360,bright:30*conversionRatio,coloration:1,dim:60*conversionRatio,luminosity:.5,saturation:0,contrast:0,shadows:0,animation:{speed:5,intensity:5,reverse:!1,type:"torch"},darkness:{min:0,max:1},color:"#fea50b",attenuation:.5}}}),canvas.scene.updateEmbeddedDocuments("Token",u);case 2:case"end":return r.stop()}},_callee13)}));return function onClick(u){return r.apply(this,arguments)}}()}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.light.lantern-shut"))},description:function description(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.light.info"))},img:"icons/sundries/lights/lantern-steel.webp",icon:["fas fa-fire-flame","fas fa-sun"],type:LIGHT_LOCALIZATION,onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee14(r){var u;return _regeneratorRuntime().wrap(function _callee14$(r){for(;;)switch(r.prev=r.next){case 0:u=canvas.tokens.controlled.map(function(r){return{_id:r.document.id,light:{alpha:.5,angle:360,bright:0,coloration:1,dim:5*conversionRatio,luminosity:.5,saturation:0,contrast:0,shadows:0,animation:{speed:5,intensity:5,reverse:!1,type:"torch"},darkness:{min:0,max:1},color:"#fea50b",attenuation:.5}}}),canvas.scene.updateEmbeddedDocuments("Token",u);case 2:case"end":return r.stop()}},_callee14)}));return function onClick(u){return r.apply(this,arguments)}}()}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.light.magical"))},description:function description(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.light.info"))},img:"icons/magic/light/explosion-star-glow-blue.webp",icon:["fas fa-fire-flame","fas fa-sun"],type:LIGHT_LOCALIZATION,onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee15(r){var u;return _regeneratorRuntime().wrap(function _callee15$(r){for(;;)switch(r.prev=r.next){case 0:u=canvas.tokens.controlled.map(function(r){return{_id:r.document.id,light:{alpha:.5,angle:360,bright:20*conversionRatio,coloration:1,dim:20*conversionRatio,luminosity:.5,saturation:0,contrast:0,shadows:0,animation:{speed:2,intensity:5,reverse:!1,type:"torch"},darkness:{min:0,max:1},color:"#b3f0ff",attenuation:.5}}}),canvas.scene.updateEmbeddedDocuments("Token",u);case 2:case"end":return r.stop()}},_callee15)}));return function onClick(u){return r.apply(this,arguments)}}()}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.light.flashlight"))},description:function description(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.light.info"))},img:"icons/magic/light/orb-lightbulb-gray.webp",icon:["fas fa-fire-flame","fas fa-sun"],type:LIGHT_LOCALIZATION,onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee16(r){var u;return _regeneratorRuntime().wrap(function _callee16$(r){for(;;)switch(r.prev=r.next){case 0:u=canvas.tokens.controlled.map(function(r){return{_id:r.document.id,light:{alpha:.5,angle:90,bright:20*conversionRatio,coloration:1,dim:20*conversionRatio,luminosity:.5,saturation:0,contrast:0,shadows:0,animation:{speed:2,intensity:2,reverse:!1,type:null},darkness:{min:0,max:1},color:"#ffffff",attenuation:.5}}}),canvas.scene.updateEmbeddedDocuments("Token",u);case 2:case"end":return r.stop()}},_callee16)}));return function onClick(u){return r.apply(this,arguments)}}()}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:function name(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.light.off"))},description:function description(){return game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.light.info"))},img:"icons/svg/light-off.svg",icon:["fas fa-fire-flame","fas fa-sun"],type:LIGHT_LOCALIZATION,onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee17(r){var u;return _regeneratorRuntime().wrap(function _callee17$(r){for(;;)switch(r.prev=r.next){case 0:u=canvas.tokens.controlled.map(function(r){return{_id:r.document.id,light:{bright:0,dim:0}}}),canvas.scene.updateEmbeddedDocuments("Token",u);case 2:case"end":return r.stop()}},_callee17)}));return function onClick(u){return r.apply(this,arguments)}}()})],SPECIAL_SEARCHES.push.apply(SPECIAL_SEARCHES,lightEffects),SPECIAL_SEARCHES.push(new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:game.i18n.localize("SCENE.FIELDS.environment.darknessLevel.label"),description:"",keywords:[],actions:[{name:game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.darkness.night")),icon:'<i class="fas fa-moon"></i>',callback:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee18(){return _regeneratorRuntime().wrap(function _callee18$(r){for(;;)switch(r.prev=r.next){case 0:canvas.scene.update({darkness:1},{animateDarkness:1e4});case 1:case"end":return r.stop()}},_callee18)}));return function callback(){return r.apply(this,arguments)}}()},{name:game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.darkness.dawn")),icon:'<i class="fas fa-sunrise"></i>',callback:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee19(){return _regeneratorRuntime().wrap(function _callee19$(r){for(;;)switch(r.prev=r.next){case 0:canvas.scene.update({darkness:.3},{animateDarkness:1e4});case 1:case"end":return r.stop()}},_callee19)}));return function callback(){return r.apply(this,arguments)}}()},{name:game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.darkness.day")),icon:'<i class="fas fa-sun"></i>',callback:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee20(){return _regeneratorRuntime().wrap(function _callee20$(r){for(;;)switch(r.prev=r.next){case 0:canvas.scene.update({darkness:0},{animateDarkness:1e4});case 1:case"end":return r.stop()}},_callee20)}));return function callback(){return r.apply(this,arguments)}}()},{name:game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.darkness.dusk")),icon:'<i class="fas fa-sunset"></i>',callback:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee21(){return _regeneratorRuntime().wrap(function _callee21$(r){for(;;)switch(r.prev=r.next){case 0:canvas.scene.update({darkness:.7},{animateDarkness:1e4});case 1:case"end":return r.stop()}},_callee21)}));return function callback(){return r.apply(this,arguments)}}()}],type:game.i18n.localize("SCENES.Darkness"),data:{},img:null,icon:["fas fa-moon-over-sun"],onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee22(){return _regeneratorRuntime().wrap(function _callee22$(r){for(;;)switch(r.prev=r.next){case 0:case"end":return r.stop()}},_callee22)}));return function onClick(){return r.apply(this,arguments)}}()})),null!==(_game$modules$get=game.modules.get("splatter"))&&void 0!==_game$modules$get&&_game$modules$get.active&&(getSplatterData=function getSplatterData(r){var u=game.settings.get("splatter","maxHp"),p=game.settings.get("splatter","currentHp"),y=game.settings.get("splatter","useWounds"),h=foundry.utils.getProperty(r.system,p),v=foundry.utils.getProperty(r.system,u),b="system.".concat(p);return{heal:function heal(u){var p=y?h-u:h+u;r.update(_defineProperty({},b,p))},damage:function damage(u){var p=y?h+u:h-u;r.update(_defineProperty({},b,p))},kill:function kill(){y?r.update(_defineProperty({},b,v)):r.update(_defineProperty({},b,0))},restore:function restore(){y?r.update(_defineProperty({},b,0)):r.update(_defineProperty({},b,v))}}},SPECIAL_SEARCHES.push(new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.kill.name")),description:game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.kill.description")),keywords:[],type:"special-app",data:{},img:null,icon:["fas fa-skull-crossbones"],onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee23(){return _regeneratorRuntime().wrap(function _callee23$(r){for(;;)switch(r.prev=r.next){case 0:canvas.tokens.controlled.map(function(r){return r.actor}).forEach(function(r){getSplatterData(r).kill()});case 2:case"end":return r.stop()}},_callee23)}));return function onClick(){return r.apply(this,arguments)}}()}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.restore.name")),description:game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.restore.description")),keywords:[],type:"special-app",data:{},img:null,icon:["fas fa-heart"],onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee24(){return _regeneratorRuntime().wrap(function _callee24$(r){for(;;)switch(r.prev=r.next){case 0:canvas.tokens.controlled.map(function(r){return r.actor}).forEach(function(r){getSplatterData(r).restore()});case 2:case"end":return r.stop()}},_callee24)}));return function onClick(){return r.apply(this,arguments)}}()}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.damage.name")),description:function description(r){var u=r.query.match(/-?\d+/);return u?parseInt(u[0]):0},keywords:[],type:"special-app",data:{},img:null,icon:["fas fa-sword"],match:function match(r){return r=r.replace(/-?\d+/g,"").trim(),this.name.toLowerCase().includes(r)},onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee25(r,u){var p,y,h,v;return _regeneratorRuntime().wrap(function _callee25$(r){for(;;)switch(r.prev=r.next){case 0:h=canvas.tokens.controlled.map(function(r){return r.actor}),v=parseInt(null!==(p=null===(y=u.query.match(/-?\d+/))||void 0===y?void 0:y[0])&&void 0!==p?p:0),h.forEach(function(r){getSplatterData(r).damage(v)});case 3:case"end":return r.stop()}},_callee25)}));return function onClick(u,p){return r.apply(this,arguments)}}()}),new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.heal.name")),description:function description(r){var u=r.query.match(/-?\d+/);return u?parseInt(u[0]):0},keywords:[],type:"special-app",data:{},img:null,icon:["fas fa-plus"],match:function match(r){return r=r.replace(/-?\d+/g,"").trim(),this.name.toLowerCase().includes(r)},onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee26(r,u){var p,y,h,v;return _regeneratorRuntime().wrap(function _callee26$(r){for(;;)switch(r.prev=r.next){case 0:h=canvas.tokens.controlled.map(function(r){return r.actor}),v=parseInt(null!==(p=null===(y=u.query.match(/-?\d+/))||void 0===y?void 0:y[0])&&void 0!==p?p:0),h.forEach(function(r){getSplatterData(r).heal(v)});case 3:case"end":return r.stop()}},_callee26)}));return function onClick(u,p){return r.apply(this,arguments)}}()}))),SPECIAL_SEARCHES.push(new _baseSearchTerm__WEBPACK_IMPORTED_MODULE_0__.g({name:game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.reindex.name")),description:game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.reindex.description")),keywords:[],type:game.i18n.localize("".concat(_main__WEBPACK_IMPORTED_MODULE_1__.D,".special.reindex.name")),data:{},img:null,icon:["fas fa-search"],onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee27(){return _regeneratorRuntime().wrap(function _callee27$(r){for(;;)switch(r.prev=r.next){case 0:CONFIG.SpotlightOmniseach.rebuildIndex();case 1:case"end":return r.stop()}},_callee27)}));return function onClick(){return r.apply(this,arguments)}}()}));case 18:case"end":return _context28.stop()}},_callee28)})),_initSpecialSearches.apply(this,arguments)}},636(r,u,p){function _typeof(r){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_typeof(r)}function _defineProperties(r,u){for(var p=0;p<u.length;p++){var y=u[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(r,_toPropertyKey(y.key),y)}}function _toPropertyKey(r){var u=function _toPrimitive(r,u){if("object"!=_typeof(r)||!r)return r;var p=r[Symbol.toPrimitive];if(void 0!==p){var y=p.call(r,u||"default");if("object"!=_typeof(y))return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===u?String:Number)(r)}(r,"string");return"symbol"==_typeof(u)?u:u+""}p.d(u,{g:()=>y});var y=function(){function BaseSearchTerm(r){var u=r.name,p=r.nameExtra,y=void 0===p?"":p,h=r.description,v=void 0===h?"":h,b=r.keywords,w=void 0===b?[]:b,k=r.actions,E=void 0===k?[]:k,O=r.dragData,P=r.type,T=r.data,S=void 0===T?{}:T,D=r.img,A=r.icon,I=r.onClick,x=void 0===I?null:I,R=r.onDragStart,G=void 0===R?null:R,L=r.onDragEnd,M=void 0===L?null:L,N=r.match,j=void 0===N?null:N,U=r.activateListeners,K=void 0===U?null:U;!function _classCallCheck(r,u){if(!(r instanceof u))throw new TypeError("Cannot call a class as a function")}(this,BaseSearchTerm),this._name="function"==typeof u?u.bind(this):function(){return u},this._description="function"==typeof v?v.bind(this):function(){return v},this._actions="function"==typeof E?E.bind(this):function(){return E},this.dragData=O,this.keywords=w.map(function(r){return r.toLowerCase()}),this.type=P,this.data=S,this.img=D,this.icon=A,this._nameExtra="function"==typeof y?y.bind(this):function(){return y},K&&(this.activateListeners=K.bind(this)),x&&(this._onClick=x.bind(this)),M&&(this._onDragEnd=M.bind(this)),G&&(this._onDragStart=G.bind(this)),j&&(this.match=j.bind(this))}return function _createClass(r,u,p){return u&&_defineProperties(r.prototype,u),p&&_defineProperties(r,p),Object.defineProperty(r,"prototype",{writable:!1}),r}(BaseSearchTerm,[{key:"onClick",value:function onClick(){this._onClick&&this._onClick.apply(this,arguments)}},{key:"onDragStart",value:function onDragStart(){this._onDragStart&&this._onDragStart.apply(this,arguments)}},{key:"onDragEnd",value:function onDragEnd(){this._onDragEnd&&this._onDragEnd.apply(this,arguments)}},{key:"match",value:function match(r){try{return foundry.applications.ux.SearchFilter.cleanQuery(this.name).toLowerCase().includes(r)||this.keywords.some(function(u){return u.includes(r)})}catch(r){return console.error("Error matching search term:",this),console.error(r),!1}}},{key:"name",get:function get(){return this._name(this)}},{key:"nameExtra",get:function get(){return this._nameExtra(this)}},{key:"description",get:function get(){return this._description(this)}},{key:"actions",get:function get(){return this._actions(this)}}]),BaseSearchTerm}()},717(r,u,p){p.d(u,{SC:()=>P,Xh:()=>buildIndex,hx:()=>O,iu:()=>T});var y=p(208),h=p(786),v=p(636),b=p(508);function _typeof(r){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_typeof(r)}function _slicedToArray(r,u){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,u){var p=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=p){var y,h,v,b,w=[],k=!0,E=!1;try{if(v=(p=p.call(r)).next,0===u){if(Object(p)!==p)return;k=!1}else for(;!(k=(y=v.call(p)).done)&&(w.push(y.value),w.length!==u);k=!0);}catch(r){E=!0,h=r}finally{try{if(!k&&null!=p.return&&(b=p.return(),Object(b)!==b))return}finally{if(E)throw h}}return w}}(r,u)||_unsupportedIterableToArray(r,u)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ownKeys(r,u){var p=Object.keys(r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(r);u&&(y=y.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),p.push.apply(p,y)}return p}function _objectSpread(r){for(var u=1;u<arguments.length;u++){var p=null!=arguments[u]?arguments[u]:{};u%2?ownKeys(Object(p),!0).forEach(function(u){_defineProperty(r,u,p[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(p)):ownKeys(Object(p)).forEach(function(u){Object.defineProperty(r,u,Object.getOwnPropertyDescriptor(p,u))})}return r}function _defineProperty(r,u,p){return(u=function _toPropertyKey(r){var u=function _toPrimitive(r,u){if("object"!=_typeof(r)||!r)return r;var p=r[Symbol.toPrimitive];if(void 0!==p){var y=p.call(r,u||"default");if("object"!=_typeof(y))return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===u?String:Number)(r)}(r,"string");return"symbol"==_typeof(u)?u:u+""}(u))in r?Object.defineProperty(r,u,{value:p,enumerable:!0,configurable:!0,writable:!0}):r[u]=p,r}function _createForOfIteratorHelper(r,u){var p="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!p){if(Array.isArray(r)||(p=_unsupportedIterableToArray(r))||u&&r&&"number"==typeof r.length){p&&(r=p);var y=0,h=function F(){};return{s:h,n:function n(){return y>=r.length?{done:!0}:{done:!1,value:r[y++]}},e:function e(r){throw r},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var v,b=!0,w=!1;return{s:function s(){p=p.call(r)},n:function n(){var r=p.next();return b=r.done,r},e:function e(r){w=!0,v=r},f:function f(){try{b||null==p.return||p.return()}finally{if(w)throw v}}}}function _regeneratorRuntime(){var r=_regenerator(),u=r.m(_regeneratorRuntime),p=(Object.getPrototypeOf?Object.getPrototypeOf(u):u.__proto__).constructor;function n(r){var u="function"==typeof r&&r.constructor;return!!u&&(u===p||"GeneratorFunction"===(u.displayName||u.name))}var y={throw:1,return:2,break:3,continue:3};function a(r){var u,p;return function(h){u||(u={stop:function stop(){return p(h.a,2)},catch:function _catch(){return h.v},abrupt:function abrupt(r,u){return p(h.a,y[r],u)},delegateYield:function delegateYield(r,y,v){return u.resultName=y,p(h.d,_regeneratorValues(r),v)},finish:function finish(r){return p(h.f,r)}},p=function t(r,p,y){h.p=u.prev,h.n=u.next;try{return r(p,y)}finally{u.next=h.n}}),u.resultName&&(u[u.resultName]=h.v,u.resultName=void 0),u.sent=h.v,u.next=h.n;try{return r.call(this,u)}finally{h.p=u.prev,h.n=u.next}}}return(_regeneratorRuntime=function _regeneratorRuntime(){return{wrap:function wrap(u,p,y,h){return r.w(a(u),p,y,h&&h.reverse())},isGeneratorFunction:n,mark:r.m,awrap:function awrap(r,u){return new _OverloadYield(r,u)},AsyncIterator:_regeneratorAsyncIterator,async:function async(r,u,p,y,h){return(n(u)?_regeneratorAsyncGen:_regeneratorAsync)(a(r),u,p,y,h)},keys:_regeneratorKeys,values:_regeneratorValues}})()}function _regeneratorValues(r){if(null!=r){var u=r["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],p=0;if(u)return u.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length))return{next:function next(){return r&&p>=r.length&&(r=void 0),{value:r&&r[p++],done:!r}}}}throw new TypeError(_typeof(r)+" is not iterable")}function _regeneratorKeys(r){var u=Object(r),p=[];for(var y in u)p.unshift(y);return function e(){for(;p.length;)if((y=p.pop())in u)return e.value=y,e.done=!1,e;return e.done=!0,e}}function _regeneratorAsync(r,u,p,y,h){var v=_regeneratorAsyncGen(r,u,p,y,h);return v.next().then(function(r){return r.done?r.value:v.next()})}function _regeneratorAsyncGen(r,u,p,y,h){return new _regeneratorAsyncIterator(_regenerator().w(r,u,p,y),h||Promise)}function _regeneratorAsyncIterator(r,u){function n(p,y,h,v){try{var b=r[p](y),w=b.value;return w instanceof _OverloadYield?u.resolve(w.v).then(function(r){n("next",r,h,v)},function(r){n("throw",r,h,v)}):u.resolve(w).then(function(r){b.value=r,h(b)},function(r){return n("throw",r,h,v)})}catch(r){v(r)}}var p;this.next||(_regeneratorDefine2(_regeneratorAsyncIterator.prototype),_regeneratorDefine2(_regeneratorAsyncIterator.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),_regeneratorDefine2(this,"_invoke",function(r,y,h){function f(){return new u(function(u,p){n(r,h,u,p)})}return p=p?p.then(f,f):f()},!0)}function _regenerator(){var r,u,p="function"==typeof Symbol?Symbol:{},y=p.iterator||"@@iterator",h=p.toStringTag||"@@toStringTag";function i(p,y,h,b){var w=y&&y.prototype instanceof Generator?y:Generator,k=Object.create(w.prototype);return _regeneratorDefine2(k,"_invoke",function(p,y,h){var b,w,k,E=0,O=h||[],P=!1,T={p:0,n:0,v:r,a:d,f:d.bind(r,4),d:function d(u,p){return b=u,w=0,k=r,T.n=p,v}};function d(p,y){for(w=p,k=y,u=0;!P&&E&&!h&&u<O.length;u++){var h,b=O[u],S=T.p,D=b[2];p>3?(h=D===y)&&(k=b[(w=b[4])?5:(w=3,3)],b[4]=b[5]=r):b[0]<=S&&((h=p<2&&S<b[1])?(w=0,T.v=y,T.n=b[1]):S<D&&(h=p<3||b[0]>y||y>D)&&(b[4]=p,b[5]=y,T.n=D,w=0))}if(h||p>1)return v;throw P=!0,y}return function(h,O,S){if(E>1)throw TypeError("Generator is already running");for(P&&1===O&&d(O,S),w=O,k=S;(u=w<2?r:k)||!P;){b||(w?w<3?(w>1&&(T.n=-1),d(w,k)):T.n=k:T.v=k);try{if(E=2,b){if(w||(h="next"),u=b[h]){if(!(u=u.call(b,k)))throw TypeError("iterator result is not an object");if(!u.done)return u;k=u.value,w<2&&(w=0)}else 1===w&&(u=b.return)&&u.call(b),w<2&&(k=TypeError("The iterator does not provide a '"+h+"' method"),w=1);b=r}else if((u=(P=T.n<0)?k:p.call(y,T))!==v)break}catch(u){b=r,w=1,k=u}finally{E=1}}return{value:u,done:P}}}(p,h,b),!0),k}var v={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}u=Object.getPrototypeOf;var b=[][y]?u(u([][y]())):(_regeneratorDefine2(u={},y,function(){return this}),u),w=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(b);function f(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,GeneratorFunctionPrototype):(r.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(r,h,"GeneratorFunction")),r.prototype=Object.create(w),r}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(w,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,h,"GeneratorFunction"),_regeneratorDefine2(w),_regeneratorDefine2(w,h,"Generator"),_regeneratorDefine2(w,y,function(){return this}),_regeneratorDefine2(w,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(r,u,p,y){var h=Object.defineProperty;try{h({},"",{})}catch(r){h=0}_regeneratorDefine2=function _regeneratorDefine(r,u,p,y){function o(u,p){_regeneratorDefine2(r,u,function(r){return this._invoke(u,p,r)})}u?h?h(r,u,{value:p,enumerable:!y,configurable:!y,writable:!y}):r[u]=p:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(r,u,p,y)}function _OverloadYield(r,u){this.v=r,this.k=u}function _toConsumableArray(r){return function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}(r)||function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||_unsupportedIterableToArray(r)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(r,u){if(r){if("string"==typeof r)return _arrayLikeToArray(r,u);var p={}.toString.call(r).slice(8,-1);return"Object"===p&&r.constructor&&(p=r.constructor.name),"Map"===p||"Set"===p?Array.from(r):"Arguments"===p||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p)?_arrayLikeToArray(r,u):void 0}}function _arrayLikeToArray(r,u){(null==u||u>r.length)&&(u=r.length);for(var p=0,y=Array(u);p<u;p++)y[p]=r[p];return y}function asyncGeneratorStep(r,u,p,y,h,v,b){try{var w=r[v](b),k=w.value}catch(r){return void p(r)}w.done?u(k):Promise.resolve(k).then(y,h)}function _asyncToGenerator(r){return function(){var u=this,p=arguments;return new Promise(function(y,h){var v=r.apply(u,p);function _next(r){asyncGeneratorStep(v,y,h,_next,_throw,"next",r)}function _throw(r){asyncGeneratorStep(v,y,h,_next,_throw,"throw",r)}_next(void 0)})}}var w=Object.keys(CONST.IMAGE_FILE_EXTENSIONS),k=Object.keys(CONST.AUDIO_FILE_EXTENSIONS),E=Object.keys(CONST.VIDEO_FILE_EXTENSIONS),O=[],P=[],T=[],S=!1;function buildIndex(){return _buildIndex.apply(this,arguments)}function _buildIndex(){return _buildIndex=_asyncToGenerator(_regeneratorRuntime().mark(function _callee(){var r,u,p,y,v,w,k,E=arguments;return _regeneratorRuntime().wrap(function _callee$(D){for(;;)switch(D.prev=D.next){case 0:if(E.length>0&&void 0!==E[0]&&E[0]&&(S=!1,O.length=0,P.length=0,T.length=0),!S){D.next=4;break}return D.abrupt("return");case 4:return S=!0,null!==(r=ui.spotlightOmnisearch)&&void 0!==r&&r._html&&(p=ui.spotlightOmnisearch._html.querySelector(".fa-search"))&&(p.classList.add("fa-spin"),p.classList.remove("fa-search"),p.classList.add("fa-spinner")),D.next=8,(0,b.g)();case 8:return D.next=10,buildModuleIntegration();case 10:return D.next=12,buildWeatherEffects();case 12:if(!(0,h.PL)("searchSettings")){D.next=15;break}return D.next=15,buildSettings();case 15:if(!(0,h.PL)("searchUtils")){D.next=18;break}return D.next=18,buildSettingsTab();case 18:if(!(0,h.PL)("searchSidebar")){D.next=21;break}return D.next=21,buildCollections();case 21:return D.next=23,buildStatusEffects();case 23:if(!(0,h.PL)("searchCompendium")){D.next=26;break}return D.next=26,buildCompendiumIndex();case 26:if(!(0,h.PL)("searchFiles")){D.next=29;break}return D.next=29,buildFiles();case 29:return y=[],Hooks.callAll("spotlightOmnisearch.indexBuilt",O,y),D.next=33,Promise.all(y);case 33:return v=new Set,O.forEach(function(r){v.add(r.type)}),w=["mp3","ogg","webm","webp","png","jpg","jpeg"],Array.from(v).forEach(function(r){var u;(u=w).push.apply(u,_toConsumableArray(r.split(" ").map(function(r){return r.toLowerCase()})))}),w.sort(function(r,u){return r.localeCompare(u)}),w=Array.from(new Set(w)),P.push.apply(P,_toConsumableArray(w)),null!==(u=ui.spotlightOmnisearch)&&void 0!==u&&u.rendered&&(k=ui.spotlightOmnisearch._html.querySelector(".fa-spinner"))&&(k.classList.remove("fa-spin"),k.classList.remove("fa-spinner"),k.classList.add("fa-search")),D.abrupt("return",O);case 42:case"end":return D.stop()}},_callee)})),_buildIndex.apply(this,arguments)}function createDocumentTypeTypeString(r,u){if(!u)return"";for(var p=u.capitalize(),y=0,h=["".concat(r.toUpperCase(),".Type").concat(p),"TYPES.".concat(r,".").concat(u)];y<h.length;y++){var v=h[y],b=game.i18n.localize(v);if(v!==b)return b}return p}function buildCompendiumIndex(){return _buildCompendiumIndex.apply(this,arguments)}function _buildCompendiumIndex(){return _buildCompendiumIndex=_asyncToGenerator(_regeneratorRuntime().mark(function _callee9(){var r,u,p,y,b,w,k,E,P;return _regeneratorRuntime().wrap(function _callee9$(T){for(;;)switch(T.prev=T.next){case 0:return r=(0,h.PL)("compendiumConfig"),u=Array.from(game.packs).filter(function(u){return(game.user.isGM||!u.private)&&!1!==r[u.metadata.id]}),p=game.i18n.localize("DOCUMENT.JournalEntryPage"),y=(0,h.PL)("fullCompendiumJournalIndex"),b=[],T.next=7,Promise.all(u.map(function(r){return r.getIndex()}));case 7:w=game.i18n.localize("PACKAGE.TagCompendium"),k=_createForOfIteratorHelper(u),T.prev=9,P=_regeneratorRuntime().mark(function _loop(){var r,u,h,k,O,P,T,S,D;return _regeneratorRuntime().wrap(function _loop$(A){for(;;)switch(A.prev=A.next){case 0:return h=E.value,k=null!==(r="system"===h.metadata.packageType?game.system.title:null===(u=game.modules.get(h.metadata.packageName))||void 0===u?void 0:u.title)&&void 0!==r?r:game.i18n.localize("PACKAGE.Type.world"),A.t0=Array,A.next=5,h.getIndex();case 5:A.t1=A.sent,O=A.t0.from.call(A.t0,A.t1),P=game.i18n.localize("DOCUMENT.".concat(h.documentName)),b.push(new v.g({name:h.title,description:k,img:h.banner,keywords:[],type:w,data:_objectSpread({},h.metadata),icon:[CONFIG[h.documentName].sidebarIcon,"fas fa-atlas"],onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:h.render(!0);case 1:case"end":return r.stop()}},_callee2)}));return function onClick(){return r.apply(this,arguments)}}()})),T=_regeneratorRuntime().mark(function _loop2(){var r,u,E;return _regeneratorRuntime().wrap(function _loop2$(O){for(;;)switch(O.prev=O.next){case 0:if(r=D[S],"JournalEntry"!==h.documentName||!y){O.next=10;break}return O.next=4,h.getDocument(r._id);case 4:u=O.sent,E=[],u.pages.forEach(function(r){var y;E.push({name:r.name,icon:'<i class="fa-solid fa-file-lines"></i>',callback:(y=_asyncToGenerator(_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,fromUuid(u.uuid);case 2:p.sent.sheet.render(!0,{pageId:r.id,anchor:null});case 4:case"end":return p.stop()}},_callee3)})),function callback(){return y.apply(this,arguments)})});var h,w,O=[],P=[];"image"===r.type&&O.push({name:game.i18n.localize("JOURNAL.ActionShow"),icon:'<i class="fa-solid fa-image"></i>',callback:(h=_asyncToGenerator(_regeneratorRuntime().mark(function _callee4(){return _regeneratorRuntime().wrap(function _callee4$(u){for(;;)switch(u.prev=u.next){case 0:new ImagePopout(r.src,{}).render(!0);case 1:case"end":return u.stop()}},_callee4)})),function callback(){return h.apply(this,arguments)})}),Object.values(r.toc).forEach(function(p){var y;P.push(p.text.toLowerCase()),O.push({name:p.text,icon:'<i class="fa-solid fa-hashtag"></i>',callback:(y=_asyncToGenerator(_regeneratorRuntime().mark(function _callee5(){return _regeneratorRuntime().wrap(function _callee5$(y){for(;;)switch(y.prev=y.next){case 0:if(!ui.simpleQuest||!ui.simpleQuest.isSimpleQuestPage(r.uuid)){y.next=2;break}return y.abrupt("return",ui.simpleQuest.openToPage(r.uuid,p.slug));case 2:return y.next=4,fromUuid(u.uuid);case 4:y.sent.sheet.render(!0,{pageId:r.id,anchor:p.slug});case 6:case"end":return y.stop()}},_callee5)})),function callback(){return y.apply(this,arguments)})})}),b.push(new v.g({name:r.name+" (".concat(u.name,")"),actions:O,keywords:P,description:k,type:p,data:_objectSpread(_objectSpread({},r),{},{documentName:r.documentName,uuid:r.uuid}),img:r.img,icon:["fas fa-atlas","fas fa-file-lines"],onClick:(w=_asyncToGenerator(_regeneratorRuntime().mark(function _callee6(){return _regeneratorRuntime().wrap(function _callee6$(p){for(;;)switch(p.prev=p.next){case 0:if(!ui.simpleQuest||!ui.simpleQuest.isSimpleQuestPage(r.uuid)){p.next=2;break}return p.abrupt("return",ui.simpleQuest.openToPage(r.uuid));case 2:return p.next=4,fromUuid(u.uuid);case 4:p.sent.sheet.render(!0,{pageId:r.id,anchor:null});case 6:case"end":return p.stop()}},_callee6)})),function onClick(){return w.apply(this,arguments)})}))}),b.push(new v.g({name:r.name,description:h.title+" - "+k,keywords:[h.title],actions:E,type:P+" "+w+createDocumentTypeTypeString(h.documentName,r.type),data:_objectSpread(_objectSpread({},r),{},{documentName:h.documentName}),img:r.img,icon:["fas fa-atlas",CONFIG[h.documentName].sidebarIcon],onClick:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function _callee7(){return _regeneratorRuntime().wrap(function _callee7$(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,fromUuid(r.uuid);case 2:u.sent.sheet.render(!0);case 4:case"end":return u.stop()}},_callee7)}));return function onClick(){return u.apply(this,arguments)}}()})),O.next=11;break;case 10:b.push(new v.g({name:r.name,description:h.title+" - "+k,keywords:[h.title],type:P+" "+w+createDocumentTypeTypeString(h.documentName,r.type),data:_objectSpread(_objectSpread({},r),{},{documentName:h.documentName}),img:r.img,icon:["fas fa-atlas",CONFIG[h.documentName].sidebarIcon],onClick:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function _callee8(){return _regeneratorRuntime().wrap(function _callee8$(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,fromUuid(r.uuid);case 2:u.sent.sheet.render(!0);case 4:case"end":return u.stop()}},_callee8)}));return function onClick(){return u.apply(this,arguments)}}()}));case 11:case"end":return O.stop()}},_loop2)}),S=0,D=O;case 11:if(!(S<D.length)){A.next=16;break}return A.delegateYield(T(),"t2",13);case 13:S++,A.next=11;break;case 16:case"end":return A.stop()}},_loop)}),k.s();case 12:if((E=k.n()).done){T.next=16;break}return T.delegateYield(P(),"t0",14);case 14:T.next=12;break;case 16:T.next=21;break;case 18:T.prev=18,T.t1=T.catch(9),k.e(T.t1);case 21:return T.prev=21,k.f(),T.finish(21);case 24:b.sort(function(r,u){return r.type.localeCompare(u.type)}),O.push.apply(O,b);case 26:case"end":return T.stop()}},_callee9,null,[[9,18,21,24]])})),_buildCompendiumIndex.apply(this,arguments)}function buildCollections(){return _buildCollections.apply(this,arguments)}function _buildCollections(){return _buildCollections=_asyncToGenerator(_regeneratorRuntime().mark(function _callee13(){var r,u,p,y,h,b,w,k;return _regeneratorRuntime().wrap(function _callee13$(E){for(;;)switch(E.prev=E.next){case 0:r=Array.from(game.collections),u=[],p=["Combat","Setting","FogExploration","ChatMessage","Folder"],y=game.i18n.localize("DOCUMENT.JournalEntryPage"),h=game.i18n.localize("PLAYERS.Title"),b=_regeneratorRuntime().mark(function _loop3(){var r,b;return _regeneratorRuntime().wrap(function _loop3$(E){for(;;)switch(E.prev=E.next){case 0:if(r=k[w],b=game.i18n.localize("DOCUMENT.".concat(r.documentName)),!p.includes(r.documentName)){E.next=4;break}return E.abrupt("return","continue");case 4:Array.from(r).forEach(function(p){var w,k,E;if(p.testUserPermission(game.user,CONST.DOCUMENT_OWNERSHIP_LEVELS.OBSERVER)){var O=[],P="",T="";p.folder&&(P="<i style='display: inline; opacity: 0.3;' class='fas fa-folder'></i> "+getFoldersRecursive(p).join(" / "));var S,D=[];if("JournalEntry"===r.documentName&&p.pages.forEach(function(r){if(r.testUserPermission(game.user,CONST.DOCUMENT_OWNERSHIP_LEVELS.OBSERVER)){var h;D.push({name:r.name,icon:'<i class="fa-solid fa-file-lines"></i>',callback:(h=_asyncToGenerator(_regeneratorRuntime().mark(function _callee0(){return _regeneratorRuntime().wrap(function _callee0$(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,fromUuid(p.uuid);case 2:u.sent.sheet.render(!0,{pageId:r.id,anchor:null});case 4:case"end":return u.stop()}},_callee0)})),function callback(){return h.apply(this,arguments)})});var b,w,k=[],E=[];"image"===r.type&&k.push({name:game.i18n.localize("JOURNAL.ActionShow"),icon:'<i class="fa-solid fa-image"></i>',callback:(b=_asyncToGenerator(_regeneratorRuntime().mark(function _callee1(){return _regeneratorRuntime().wrap(function _callee1$(u){for(;;)switch(u.prev=u.next){case 0:new ImagePopout(r.src,{}).render(!0);case 1:case"end":return u.stop()}},_callee1)})),function callback(){return b.apply(this,arguments)})}),Object.values(r.toc).forEach(function(u){var y;E.push(u.text.toLowerCase()),k.push({name:u.text,icon:'<i class="fa-solid fa-hashtag"></i>',callback:(y=_asyncToGenerator(_regeneratorRuntime().mark(function _callee10(){return _regeneratorRuntime().wrap(function _callee10$(y){for(;;)switch(y.prev=y.next){case 0:if(!ui.simpleQuest||!ui.simpleQuest.isSimpleQuestPage(r.uuid)){y.next=2;break}return y.abrupt("return",ui.simpleQuest.openToPage(r.uuid,u.slug));case 2:return y.next=4,fromUuid(p.uuid);case 4:y.sent.sheet.render(!0,{pageId:r.id,anchor:u.slug});case 6:case"end":return y.stop()}},_callee10)})),function callback(){return y.apply(this,arguments)})})}),u.push(new v.g({name:r.name+" (".concat(p.name,")"),actions:k,keywords:E,description:P,type:y,data:_objectSpread(_objectSpread({},r),{},{documentName:r.documentName,uuid:r.uuid}),img:r.img,icon:["fas fa-earth-europe","fas fa-file-lines"],onClick:(w=_asyncToGenerator(_regeneratorRuntime().mark(function _callee11(){return _regeneratorRuntime().wrap(function _callee11$(u){for(;;)switch(u.prev=u.next){case 0:if(!ui.simpleQuest||!ui.simpleQuest.isSimpleQuestPage(r.uuid)){u.next=2;break}return u.abrupt("return",ui.simpleQuest.openToPage(r.uuid));case 2:return u.next=4,fromUuid(p.uuid);case 4:u.sent.sheet.render(!0,{pageId:r.id,anchor:null});case 6:case"end":return u.stop()}},_callee11)})),function onClick(){return w.apply(this,arguments)})}))}}),"Actor"===r.documentName){var A,I=null===(A=p.flags["item-piles"])||void 0===A||null===(A=A.data)||void 0===A?void 0:A.type;I&&(O.push(I),T+=" ".concat(I)),p.hasPlayerOwner&&(T+=" ".concat(h))}u.push(new v.g({name:null!==(w=null!==(k=p.name)&&void 0!==k?k:null===(E=p.speaker)||void 0===E?void 0:E.alias)&&void 0!==w?w:p.content,description:P,keywords:O,actions:D,type:b+T,data:_objectSpread(_objectSpread({},p),{},{documentName:r.documentName,uuid:p.uuid}),img:p.img,icon:["fas fa-earth-europe",CONFIG[r.documentName].sidebarIcon],onClick:(S=_asyncToGenerator(_regeneratorRuntime().mark(function _callee12(){return _regeneratorRuntime().wrap(function _callee12$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fromUuid(p.uuid);case 2:r.sent.sheet.render(!0);case 4:case"end":return r.stop()}},_callee12)})),function onClick(){return S.apply(this,arguments)})}))}});case 6:case"end":return E.stop()}},_loop3)}),w=0,k=r;case 7:if(!(w<k.length)){E.next=15;break}return E.delegateYield(b(),"t0",9);case 9:if("continue"!==E.t0){E.next=12;break}return E.abrupt("continue",12);case 12:w++,E.next=7;break;case 15:u.sort(function(r,u){return r.type.localeCompare(u.type)}),O.push.apply(O,u);case 17:case"end":return E.stop()}},_callee13)})),_buildCollections.apply(this,arguments)}function buildSettings(){return _buildSettings.apply(this,arguments)}function _buildSettings(){return _buildSettings=_asyncToGenerator(_regeneratorRuntime().mark(function _callee16(){var r,u,p,y;return _regeneratorRuntime().wrap(function _callee16$(h){for(;;)switch(h.prev=h.next){case 0:r=[],u=game.i18n.localize("DOCUMENT.Setting"),p=function processSetting(p){var y,h,b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(b=!0===b,p.name&&(p.config||b)&&!1!==p.config&&(game.user.isGM||"world"!==p.scope)&&(game.user.isGM||!p.restricted)){var w="";p.type===Boolean&&(w=function toggle(){var r=game.settings.get(p.namespace,p.key);return'<i class="s-toggle-setting fad fa-toggle-'.concat(r?"on":"off",'" data-namespace="').concat(p.namespace,'" data-key="').concat(p.key,'"></i>')});var k,E=null!==(y=p.icon)&&void 0!==y?y:"fas fa-cogs",O="";(O=p.namespace===game.system.id?game.system.title:"core"===p.namespace?game.i18n.localize("Core"):null===(h=game.modules.get(p.namespace))||void 0===h?void 0:h.title)&&(O="<strong>".concat(O,"</strong> - ")),r.push(new v.g({name:game.i18n.localize(p.name),nameExtra:w,description:O+game.i18n.localize(p.hint),query:p.key,keywords:["".concat(p.key).concat(p.namespace)],type:u,data:_objectSpread({},p),img:null,icon:[E],onClick:(k=_asyncToGenerator(_regeneratorRuntime().mark(function _callee14(){return _regeneratorRuntime().wrap(function _callee14$(r){for(;;)switch(r.prev=r.next){case 0:if(!b){r.next=3;break}return(new p.type).render(!0),r.abrupt("return");case 3:game.settings.sheet.render(!0),Hooks.once("renderSettingsConfig",function(r,u){u=u[0];var y=p.namespace===game.system.id?"system":p.namespace,h=u.querySelector('.category-tab[data-tab="'.concat(y,'"]'));h&&h.click();var v=u.querySelector('[data-setting-id="'.concat(p.namespace+"."+p.key,'"]'));v&&(setTimeout(function(){v.scrollIntoView({behavior:"smooth"})},100),v.style.backgroundColor="#0000ff29")});case 5:case"end":return r.stop()}},_callee14)})),function onClick(){return k.apply(this,arguments)})}))}},game.settings.menus.forEach(function(r){return p(r,!0)}),game.settings.settings.forEach(p),y=game.i18n.localize("spotlight-omnisearch.KEYBINDING"),game.keybindings.actions.forEach(function(u,p){if(game.user.isGM||!u.restricted){var h,b=game.i18n.localize(u.name),w="";game.keybindings.bindings.get(p).forEach(function(r){w+='<span class="key">'.concat(foundry.applications.sidebar.apps.ControlsConfig.humanizeBinding(r),"</span>")}),u.hint&&(w+=game.i18n.localize(u.hint)),r.push(new v.g({name:b,description:w,keywords:[],type:y,data:_objectSpread({},u),img:null,icon:["fas fa-keyboard"],onClick:(h=_asyncToGenerator(_regeneratorRuntime().mark(function _callee15(){return _regeneratorRuntime().wrap(function _callee15$(r){for(;;)switch(r.prev=r.next){case 0:(new KeybindingsConfig).render(!0),Hooks.once("renderKeybindingsConfig",function(r,y){var h=(y=y[0]).querySelector('.tab[data-tab="'.concat(u.namespace,'"]')).querySelector('[data-action-id="'.concat(p,'"]'));h&&(setTimeout(function(){h.scrollIntoView({behavior:"smooth"})},100),h.style.backgroundColor="#0000ff29")});case 2:case"end":return r.stop()}},_callee15)})),function onClick(){return h.apply(this,arguments)})}))}}),O.push.apply(O,r);case 8:case"end":return h.stop()}},_callee16)})),_buildSettings.apply(this,arguments)}function buildSettingsTab(){return _buildSettingsTab.apply(this,arguments)}function _buildSettingsTab(){return _buildSettingsTab=_asyncToGenerator(_regeneratorRuntime().mark(function _callee18(){var r,u,p,y;return _regeneratorRuntime().wrap(function _callee18$(h){for(;;)switch(h.prev=h.next){case 0:r=document.querySelector(".settings-sidebar#settings"),u=r.querySelectorAll("button"),p=game.i18n.localize("SIDEBAR.TabSettings"),y=[],u.forEach(function(r){var u=r.innerText.trim(),h=r.querySelector("i");if(h){var b,w=h.className;if(u)y.push(new v.g({name:u,keywords:[],type:p,data:{},img:null,icon:[w],onClick:(b=_asyncToGenerator(_regeneratorRuntime().mark(function _callee17(){return _regeneratorRuntime().wrap(function _callee17$(u){for(;;)switch(u.prev=u.next){case 0:r.click();case 1:case"end":return u.stop()}},_callee17)})),function onClick(){return b.apply(this,arguments)})}))}}),O.push.apply(O,y);case 6:case"end":return h.stop()}},_callee18)})),_buildSettingsTab.apply(this,arguments)}var D=null;function buildFiles(){return _buildFiles.apply(this,arguments)}function _buildFiles(){return _buildFiles=_asyncToGenerator(_regeneratorRuntime().mark(function _callee22(){var r,u,p,h,b,O;return _regeneratorRuntime().wrap(function _callee22$(P){for(;;)switch(P.prev=P.next){case 0:if(game.user.isGM){P.next=2;break}return P.abrupt("return");case 2:if(u=null===(r=canvas.deepSearchCache)||void 0===r?void 0:r._fileIndexCache){P.next=5;break}return P.abrupt("return");case 5:p=[],h=_regeneratorRuntime().mark(function _loop4(){var r,u,h,P,T,S,A;return _regeneratorRuntime().wrap(function _loop4$(I){for(;;)switch(I.prev=I.next){case 0:r=_slicedToArray(O[b],2),u=r[0],h=r[1],P=u.split(".").pop().toLowerCase(),T="fas fa-file",S=!1,A=!1,w.includes(P)&&(T="fas fa-image",S=!0),E.includes(P)&&(T="fas fa-film",S=!0),k.includes(P)&&(T="fas fa-volume-up",A=!0),h.forEach(function(r){var h,b,w=null;S&&(w={type:"Tile",texture:{src:r},fromFilePicker:!0,tileSize:null!==(h=null===(b=canvas)||void 0===b||null===(b=b.grid)||void 0===b?void 0:b.size)&&void 0!==h?h:100});A&&(w={src:r});var k,E,O=null,P=[];A&&(O=function(){var p=_asyncToGenerator(_regeneratorRuntime().mark(function _callee19(p){var y,h,v,b,w,k,E,O,P,T,S,D;return _regeneratorRuntime().wrap(function _callee19$(A){for(;;)switch(A.prev=A.next){case 0:if(y=document.elementFromPoint(p.clientX,p.clientY)){A.next=3;break}return A.abrupt("return");case 3:console.log("Dropped audio",y),h=y.closest(".document.playlist"),v=y.closest("#board"),h&&(b=game.playlists.get(h.dataset.entryId),w=u.split(".").slice(0,-1).join("."),k=decodeURIComponent(w),b.createEmbeddedDocuments("PlaylistSound",[{name:k,path:r}])),v&&(E=[p.clientX,p.clientY],O=E[0],P=E[1],T=canvas.stage.worldTransform,S=(O-T.tx)/canvas.stage.scale.x,D=(P-T.ty)/canvas.stage.scale.y,canvas.sounds.activate(),canvas.scene.createEmbeddedDocuments("AmbientSound",[{path:r,radius:3*canvas.scene.dimensions.distance,x:S,y:D}]));case 8:case"end":return A.stop()}},_callee19)}));return function onDrop(r){return p.apply(this,arguments)}}(),P.push({name:game.i18n.localize("".concat(y.D,".actions.playForEveryone")),icon:'<i class="fas fa-play"></i>',callback:(k=_asyncToGenerator(_regeneratorRuntime().mark(function _callee20(){return _regeneratorRuntime().wrap(function _callee20$(u){for(;;)switch(u.prev=u.next){case 0:return D&&D.stop(),u.next=3,foundry.audio.AudioHelper.play({src:r,autoplay:!0,volume:.7,loop:!1},!0);case 3:case"end":return u.stop()}},_callee20)})),function callback(){return k.apply(this,arguments)})})),p.push(new v.g({name:decodeURIComponent(u),keywords:[r],type:"file "+u.split(".").pop().toLowerCase(),dragData:w,img:null,actions:P,icon:[T],onDragEnd:O,onClick:(E=_asyncToGenerator(_regeneratorRuntime().mark(function _callee21(){var u;return _regeneratorRuntime().wrap(function _callee21$(p){for(;;)switch(p.prev=p.next){case 0:if(S&&new ImagePopout(r,{}).render(!0),!A){p.next=8;break}return D&&D.stop(),p.next=5,foundry.audio.AudioHelper.play({src:r,autoplay:!0,volume:.5,loop:!1},!1);case 5:D=p.sent,u=D,setTimeout(function(){u===D&&D.stop()},5e3);case 8:case"end":return p.stop()}},_callee21)})),function onClick(){return E.apply(this,arguments)})}))});case 9:case"end":return I.stop()}},_loop4)}),b=0,O=Object.entries(u);case 8:if(!(b<O.length)){P.next=13;break}return P.delegateYield(h(),"t0",10);case 10:b++,P.next=8;break;case 13:T=p;case 14:case"end":return P.stop()}},_callee22)})),_buildFiles.apply(this,arguments)}function getFoldersRecursive(r){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return r.folder?(u.push(r.folder.name),getFoldersRecursive(r.folder,u)):u}function buildStatusEffects(){return _buildStatusEffects.apply(this,arguments)}function _buildStatusEffects(){return _buildStatusEffects=_asyncToGenerator(_regeneratorRuntime().mark(function _callee24(){var r,u,p,y;return _regeneratorRuntime().wrap(function _callee24$(h){for(;;)switch(h.prev=h.next){case 0:r=CONFIG.statusEffects,u=_createForOfIteratorHelper(r),h.prev=2,y=_regeneratorRuntime().mark(function _loop5(){var r;return _regeneratorRuntime().wrap(function _loop5$(u){for(;;)switch(u.prev=u.next){case 0:if((r=p.value).name){u.next=3;break}return u.abrupt("return","continue");case 3:O.push(new v.g({name:function name(){return game.i18n.localize(r.name)},keywords:[],type:"statusEffect",data:_objectSpread({},r),img:r.icon,icon:["fas fa-earth-europe","fas fa-bolt"],onClick:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function _callee23(){return _regeneratorRuntime().wrap(function _callee23$(u){for(;;)switch(u.prev=u.next){case 0:canvas.tokens.controlled.forEach(function(u){u.toggleEffect(r)});case 1:case"end":return u.stop()}},_callee23)}));return function onClick(){return u.apply(this,arguments)}}()}));case 4:case"end":return u.stop()}},_loop5)}),u.s();case 5:if((p=u.n()).done){h.next=12;break}return h.delegateYield(y(),"t0",7);case 7:if("continue"!==h.t0){h.next=10;break}return h.abrupt("continue",10);case 10:h.next=5;break;case 12:h.next=17;break;case 14:h.prev=14,h.t1=h.catch(2),u.e(h.t1);case 17:return h.prev=17,u.f(),h.finish(17);case 20:case"end":return h.stop()}},_callee24,null,[[2,14,17,20]])})),_buildStatusEffects.apply(this,arguments)}function buildModuleIntegration(){return _buildModuleIntegration.apply(this,arguments)}function _buildModuleIntegration(){return _buildModuleIntegration=_asyncToGenerator(_regeneratorRuntime().mark(function _callee29(){var r,u,p,y,h,b,w,k,E,P,T,S,D,A,I,x;return _regeneratorRuntime().wrap(function _callee29$(R){for(;;)switch(R.prev=R.next){case 0:if(null===(r=game.modules.get("dfreds-convenient-effects"))||void 0===r||!r.active){R.next=19;break}p=game.dfreds.effectInterface.findEffects(),y=game.modules.get("dfreds-convenient-effects").title,h=_createForOfIteratorHelper(p),R.prev=4,w=_regeneratorRuntime().mark(function _loop6(){var r;return _regeneratorRuntime().wrap(function _loop6$(u){for(;;)switch(u.prev=u.next){case 0:r=b.value,O.push(new v.g({name:r.name,description:r.description,keywords:[],type:y,data:_objectSpread({},r),img:r.img,icon:["fas fa-hand-sparkles","fas fa-bolt"],onClick:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function _callee25(){return _regeneratorRuntime().wrap(function _callee25$(u){for(;;)switch(u.prev=u.next){case 0:game.dfreds.effectInterface.toggleEffect({effectId:r.id});case 1:case"end":return u.stop()}},_callee25)}));return function onClick(){return u.apply(this,arguments)}}()}));case 2:case"end":return u.stop()}},_loop6)}),h.s();case 7:if((b=h.n()).done){R.next=11;break}return R.delegateYield(w(),"t0",9);case 9:R.next=7;break;case 11:R.next=16;break;case 13:R.prev=13,R.t1=R.catch(4),h.e(R.t1);case 16:return R.prev=16,h.f(),R.finish(16);case 19:if(game.itempiles&&(k=Array.from(game.users).filter(function(r){return r!==game.user}),E=k.map(function(r){return{name:r.name,icon:'<i class="fas fa-handshake"></i>',callback:(u=_asyncToGenerator(_regeneratorRuntime().mark(function _callee26(){return _regeneratorRuntime().wrap(function _callee26$(u){for(;;)switch(u.prev=u.next){case 0:game.itempiles.API.requestTrade(r);case 1:case"end":return u.stop()}},_callee26)})),function callback(){return u.apply(this,arguments)})};var u}),O.push(new v.g({name:game.i18n.localize("ITEM-PILES.ContextMenu.RequestTrade"),actions:E,keywords:[],type:"item-piles",data:{},img:null,icon:["fas fa-boxes"],onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee27(){return _regeneratorRuntime().wrap(function _callee27$(r){for(;;)switch(r.prev=r.next){case 0:game.itempiles.toggle();case 1:case"end":return r.stop()}},_callee27)}));return function onClick(){return r.apply(this,arguments)}}()}))),null===(u=game.modules.get("mastercrafted"))||void 0===u||!u.active){R.next=53;break}P=ui.RecipeApp._currentApp._recipeBooks,T=_createForOfIteratorHelper(P),R.prev=23,T.s();case 25:if((S=T.n()).done){R.next=45;break}D=S.value,A=_createForOfIteratorHelper(D.recipes),R.prev=28,x=_regeneratorRuntime().mark(function _loop7(){var r;return _regeneratorRuntime().wrap(function _loop7$(u){for(;;)switch(u.prev=u.next){case 0:r=I.value,O.push(new v.g({name:r.name,description:D.name,keywords:[],type:"mastercrafted recipe",data:{},img:r.img,icon:["fas fa-book","fas fa-hammer"],onClick:function(){var u=_asyncToGenerator(_regeneratorRuntime().mark(function _callee28(){return _regeneratorRuntime().wrap(function _callee28$(u){for(;;)switch(u.prev=u.next){case 0:new ui.RecipeApp(null,null,r.name).render(!0);case 1:case"end":return u.stop()}},_callee28)}));return function onClick(){return u.apply(this,arguments)}}()}));case 2:case"end":return u.stop()}},_loop7)}),A.s();case 31:if((I=A.n()).done){R.next=35;break}return R.delegateYield(x(),"t2",33);case 33:R.next=31;break;case 35:R.next=40;break;case 37:R.prev=37,R.t3=R.catch(28),A.e(R.t3);case 40:return R.prev=40,A.f(),R.finish(40);case 43:R.next=25;break;case 45:R.next=50;break;case 47:R.prev=47,R.t4=R.catch(23),T.e(R.t4);case 50:return R.prev=50,T.f(),R.finish(50);case 53:case"end":return R.stop()}},_callee29,null,[[4,13,16,19],[23,47,50,53],[28,37,40,43]])})),_buildModuleIntegration.apply(this,arguments)}function buildWeatherEffects(){return _buildWeatherEffects.apply(this,arguments)}function _buildWeatherEffects(){return _buildWeatherEffects=_asyncToGenerator(_regeneratorRuntime().mark(function _callee32(){var r,u,p,y;return _regeneratorRuntime().wrap(function _callee32$(h){for(;;)switch(h.prev=h.next){case 0:if(game.user.isGM){h.next=2;break}return h.abrupt("return");case 2:r=CONFIG.weatherEffects,u=_regeneratorRuntime().mark(function _loop8(){var r,u,h,b,w;return _regeneratorRuntime().wrap(function _loop8$(k){for(;;)switch(k.prev=k.next){case 0:r=_slicedToArray(y[p],2),u=r[0],h=r[1],CONFIG.fxmaster&&u.includes("fxmaster")?(b=u.replace("fxmaster.",""),w=CONFIG.fxmaster.particleEffects[b],O.push(new v.g({name:game.i18n.localize(w.label),description:w.description,keywords:[game.i18n.localize("SCENE.FIELDS.weather.label")],type:"fxmaster "+game.i18n.localize("SCENE.FIELDS.weather.label"),img:w.icon,icon:["fas fa-wand-magic-sparkles","fas fa-cloud-rain"],onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee30(){return _regeneratorRuntime().wrap(function _callee30$(r){for(;;)switch(r.prev=r.next){case 0:game.scenes.viewed.weather===u?game.scenes.viewed.update({weather:""}):game.scenes.viewed.update({weather:u});case 2:case"end":return r.stop()}},_callee30)}));return function onClick(){return r.apply(this,arguments)}}()}))):O.push(new v.g({name:game.i18n.localize(h.label),description:h.description,keywords:[game.i18n.localize("SCENE.FIELDS.weather.label")],type:game.i18n.localize("SCENE.FIELDS.weather.label"),icon:["fas fa-map","fas fa-cloud-sun-rain"],onClick:function(){var r=_asyncToGenerator(_regeneratorRuntime().mark(function _callee31(){return _regeneratorRuntime().wrap(function _callee31$(r){for(;;)switch(r.prev=r.next){case 0:game.scenes.viewed.weather===u?game.scenes.viewed.update({weather:""}):game.scenes.viewed.update({weather:u});case 2:case"end":return r.stop()}},_callee31)}));return function onClick(){return r.apply(this,arguments)}}()}));case 3:case"end":return k.stop()}},_loop8)}),p=0,y=Object.entries(r);case 5:if(!(p<y.length)){h.next=10;break}return h.delegateYield(u(),"t0",7);case 7:p++,h.next=5;break;case 10:case"end":return h.stop()}},_callee32)})),_buildWeatherEffects.apply(this,arguments)}},786(r,u,p){p.d(u,{Nq:()=>registerSettings,PL:()=>getSetting,ZC:()=>setSetting});var y=p(208),h=p(150);function _typeof(r){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_typeof(r)}function _regeneratorRuntime(){var r=_regenerator(),u=r.m(_regeneratorRuntime),p=(Object.getPrototypeOf?Object.getPrototypeOf(u):u.__proto__).constructor;function n(r){var u="function"==typeof r&&r.constructor;return!!u&&(u===p||"GeneratorFunction"===(u.displayName||u.name))}var y={throw:1,return:2,break:3,continue:3};function a(r){var u,p;return function(h){u||(u={stop:function stop(){return p(h.a,2)},catch:function _catch(){return h.v},abrupt:function abrupt(r,u){return p(h.a,y[r],u)},delegateYield:function delegateYield(r,y,v){return u.resultName=y,p(h.d,_regeneratorValues(r),v)},finish:function finish(r){return p(h.f,r)}},p=function t(r,p,y){h.p=u.prev,h.n=u.next;try{return r(p,y)}finally{u.next=h.n}}),u.resultName&&(u[u.resultName]=h.v,u.resultName=void 0),u.sent=h.v,u.next=h.n;try{return r.call(this,u)}finally{h.p=u.prev,h.n=u.next}}}return(_regeneratorRuntime=function _regeneratorRuntime(){return{wrap:function wrap(u,p,y,h){return r.w(a(u),p,y,h&&h.reverse())},isGeneratorFunction:n,mark:r.m,awrap:function awrap(r,u){return new _OverloadYield(r,u)},AsyncIterator:_regeneratorAsyncIterator,async:function async(r,u,p,y,h){return(n(u)?_regeneratorAsyncGen:_regeneratorAsync)(a(r),u,p,y,h)},keys:_regeneratorKeys,values:_regeneratorValues}})()}function _regeneratorValues(r){if(null!=r){var u=r["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],p=0;if(u)return u.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length))return{next:function next(){return r&&p>=r.length&&(r=void 0),{value:r&&r[p++],done:!r}}}}throw new TypeError(_typeof(r)+" is not iterable")}function _regeneratorKeys(r){var u=Object(r),p=[];for(var y in u)p.unshift(y);return function e(){for(;p.length;)if((y=p.pop())in u)return e.value=y,e.done=!1,e;return e.done=!0,e}}function _regeneratorAsync(r,u,p,y,h){var v=_regeneratorAsyncGen(r,u,p,y,h);return v.next().then(function(r){return r.done?r.value:v.next()})}function _regeneratorAsyncGen(r,u,p,y,h){return new _regeneratorAsyncIterator(_regenerator().w(r,u,p,y),h||Promise)}function _regeneratorAsyncIterator(r,u){function n(p,y,h,v){try{var b=r[p](y),w=b.value;return w instanceof _OverloadYield?u.resolve(w.v).then(function(r){n("next",r,h,v)},function(r){n("throw",r,h,v)}):u.resolve(w).then(function(r){b.value=r,h(b)},function(r){return n("throw",r,h,v)})}catch(r){v(r)}}var p;this.next||(_regeneratorDefine2(_regeneratorAsyncIterator.prototype),_regeneratorDefine2(_regeneratorAsyncIterator.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),_regeneratorDefine2(this,"_invoke",function(r,y,h){function f(){return new u(function(u,p){n(r,h,u,p)})}return p=p?p.then(f,f):f()},!0)}function _regenerator(){var r,u,p="function"==typeof Symbol?Symbol:{},y=p.iterator||"@@iterator",h=p.toStringTag||"@@toStringTag";function i(p,y,h,b){var w=y&&y.prototype instanceof Generator?y:Generator,k=Object.create(w.prototype);return _regeneratorDefine2(k,"_invoke",function(p,y,h){var b,w,k,E=0,O=h||[],P=!1,T={p:0,n:0,v:r,a:d,f:d.bind(r,4),d:function d(u,p){return b=u,w=0,k=r,T.n=p,v}};function d(p,y){for(w=p,k=y,u=0;!P&&E&&!h&&u<O.length;u++){var h,b=O[u],S=T.p,D=b[2];p>3?(h=D===y)&&(k=b[(w=b[4])?5:(w=3,3)],b[4]=b[5]=r):b[0]<=S&&((h=p<2&&S<b[1])?(w=0,T.v=y,T.n=b[1]):S<D&&(h=p<3||b[0]>y||y>D)&&(b[4]=p,b[5]=y,T.n=D,w=0))}if(h||p>1)return v;throw P=!0,y}return function(h,O,S){if(E>1)throw TypeError("Generator is already running");for(P&&1===O&&d(O,S),w=O,k=S;(u=w<2?r:k)||!P;){b||(w?w<3?(w>1&&(T.n=-1),d(w,k)):T.n=k:T.v=k);try{if(E=2,b){if(w||(h="next"),u=b[h]){if(!(u=u.call(b,k)))throw TypeError("iterator result is not an object");if(!u.done)return u;k=u.value,w<2&&(w=0)}else 1===w&&(u=b.return)&&u.call(b),w<2&&(k=TypeError("The iterator does not provide a '"+h+"' method"),w=1);b=r}else if((u=(P=T.n<0)?k:p.call(y,T))!==v)break}catch(u){b=r,w=1,k=u}finally{E=1}}return{value:u,done:P}}}(p,h,b),!0),k}var v={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}u=Object.getPrototypeOf;var b=[][y]?u(u([][y]())):(_regeneratorDefine2(u={},y,function(){return this}),u),w=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(b);function f(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,GeneratorFunctionPrototype):(r.__proto__=GeneratorFunctionPrototype,_regeneratorDefine2(r,h,"GeneratorFunction")),r.prototype=Object.create(w),r}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine2(w,"constructor",GeneratorFunctionPrototype),_regeneratorDefine2(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine2(GeneratorFunctionPrototype,h,"GeneratorFunction"),_regeneratorDefine2(w),_regeneratorDefine2(w,h,"Generator"),_regeneratorDefine2(w,y,function(){return this}),_regeneratorDefine2(w,"toString",function(){return"[object Generator]"}),(_regenerator=function _regenerator(){return{w:i,m:f}})()}function _regeneratorDefine2(r,u,p,y){var h=Object.defineProperty;try{h({},"",{})}catch(r){h=0}_regeneratorDefine2=function _regeneratorDefine(r,u,p,y){function o(u,p){_regeneratorDefine2(r,u,function(r){return this._invoke(u,p,r)})}u?h?h(r,u,{value:p,enumerable:!y,configurable:!y,writable:!y}):r[u]=p:(o("next",0),o("throw",1),o("return",2))},_regeneratorDefine2(r,u,p,y)}function _OverloadYield(r,u){this.v=r,this.k=u}function _slicedToArray(r,u){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,u){var p=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=p){var y,h,v,b,w=[],k=!0,E=!1;try{if(v=(p=p.call(r)).next,0===u){if(Object(p)!==p)return;k=!1}else for(;!(k=(y=v.call(p)).done)&&(w.push(y.value),w.length!==u);k=!0);}catch(r){E=!0,h=r}finally{try{if(!k&&null!=p.return&&(b=p.return(),Object(b)!==b))return}finally{if(E)throw h}}return w}}(r,u)||function _unsupportedIterableToArray(r,u){if(r){if("string"==typeof r)return _arrayLikeToArray(r,u);var p={}.toString.call(r).slice(8,-1);return"Object"===p&&r.constructor&&(p=r.constructor.name),"Map"===p||"Set"===p?Array.from(r):"Arguments"===p||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p)?_arrayLikeToArray(r,u):void 0}}(r,u)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,u){(null==u||u>r.length)&&(u=r.length);for(var p=0,y=Array(u);p<u;p++)y[p]=r[p];return y}function asyncGeneratorStep(r,u,p,y,h,v,b){try{var w=r[v](b),k=w.value}catch(r){return void p(r)}w.done?u(k):Promise.resolve(k).then(y,h)}function registerSettings(){!function registerSettingsArray(r){for(var u=0,p=Object.entries(r);u<p.length;u++){var h=_slicedToArray(p[u],2),v=h[0],b=h[1];game.settings.register(y.D,v,b)}}({gmOnly:{name:"".concat(y.D,".settings.gmOnly.name"),hint:"".concat(y.D,".settings.gmOnly.hint"),scope:"world",config:!0,default:!1,type:Boolean},compactMode:{name:"".concat(y.D,".settings.compactMode.name"),hint:"".concat(y.D,".settings.compactMode.hint"),scope:"client",config:!0,default:!1,type:Boolean,onChange:function onChange(r){var u;return null===(u=ui.spotlightOmnisearch)||void 0===u?void 0:u.classList.toggle("compact",r)}},clickToDismiss:{name:"".concat(y.D,".settings.clickToDismiss.name"),hint:"".concat(y.D,".settings.clickToDismiss.hint"),scope:"client",config:!0,default:!1,type:Boolean},saveLastSearch:{name:"".concat(y.D,".settings.saveLastSearch.name"),hint:"".concat(y.D,".settings.saveLastSearch.hint"),scope:"client",config:!0,default:!1,type:Boolean},useHistory:{name:"".concat(y.D,".settings.useHistory.name"),hint:"".concat(y.D,".settings.useHistory.hint"),scope:"client",config:!0,default:!0,type:Boolean},position:{name:"".concat(y.D,".settings.position.name"),hint:"".concat(y.D,".settings.position.hint"),scope:"client",config:!0,default:"save",type:String,choices:{default:"".concat(y.D,".settings.position.choices.default"),save:"".concat(y.D,".settings.position.choices.save")}},alwaysOnTop:{name:"".concat(y.D,".settings.alwaysOnTop.name"),hint:"".concat(y.D,".settings.alwaysOnTop.hint"),scope:"client",config:!0,default:!1,type:Boolean},enableCtrlSpace:{name:"".concat(y.D,".settings.enableCtrlSpace.name"),hint:"".concat(y.D,".settings.enableCtrlSpace.hint"),scope:"client",config:!0,default:!0,type:Boolean},spotlightWidth:{name:"".concat(y.D,".settings.spotlightWidth.name"),hint:"".concat(y.D,".settings.spotlightWidth.hint"),scope:"world",config:!0,default:700,type:Number,range:{min:400,max:1e3,step:50}},showImages:{name:"".concat(y.D,".settings.showImages.name"),hint:"".concat(y.D,".settings.showImages.hint"),scope:"world",config:!0,default:!0,type:Boolean},searchFiles:{name:"".concat(y.D,".settings.searchFiles.name"),hint:"".concat(y.D,".settings.searchFiles.hint"),scope:"world",config:!0,default:!1,type:Boolean},searchSettings:{name:"".concat(y.D,".settings.searchSettings.name"),hint:"".concat(y.D,".settings.searchSettings.hint"),scope:"world",config:!0,default:!0,type:Boolean},searchCompendium:{name:"".concat(y.D,".settings.searchCompendium.name"),hint:"".concat(y.D,".settings.searchCompendium.hint"),scope:"world",config:!0,default:!0,type:Boolean},fullCompendiumJournalIndex:{name:"".concat(y.D,".settings.fullCompendiumJournalIndex.name"),hint:"".concat(y.D,".settings.fullCompendiumJournalIndex.hint"),scope:"world",config:!0,default:!1,type:Boolean},searchSidebar:{name:"".concat(y.D,".settings.searchSidebar.name"),hint:"".concat(y.D,".settings.searchSidebar.hint"),scope:"world",config:!0,default:!0,type:Boolean},searchUtils:{name:"".concat(y.D,".settings.searchUtils.name"),hint:"".concat(y.D,".settings.searchUtils.hint"),scope:"world",config:!0,default:!0,type:Boolean},useMetricForLights:{name:"".concat(y.D,".settings.useMetricForLights.name"),hint:"".concat(y.D,".settings.useMetricForLights.hint"),scope:"world",config:!0,default:!1,type:Boolean},spotlightPosition:{scope:"client",config:!1,default:null,type:Object},firstTime:{scope:"client",config:!1,default:!0,type:Boolean},appData:{scope:"world",config:!1,default:{},type:Object,onChange:function onChange(r){var u;null!==(u=ui.spotlightOmnisearch)&&void 0!==u&&u.rendered&&("counter"in r&&game.user.isGM||ui.spotlightOmnisearch._onSearch()),(0,h.u)()}},recent:{scope:"client",config:!1,default:[],type:Array}})}function getSetting(r){return game.settings.get(y.D,r)}function setSetting(r,u){return _setSetting.apply(this,arguments)}function _setSetting(){return _setSetting=function _asyncToGenerator(r){return function(){var u=this,p=arguments;return new Promise(function(y,h){var v=r.apply(u,p);function _next(r){asyncGeneratorStep(v,y,h,_next,_throw,"next",r)}function _throw(r){asyncGeneratorStep(v,y,h,_next,_throw,"throw",r)}_next(void 0)})}}(_regeneratorRuntime().mark(function _callee(r,u){return _regeneratorRuntime().wrap(function _callee$(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,game.settings.set(y.D,r,u);case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},_callee)})),_setSetting.apply(this,arguments)}}},__webpack_module_cache__={};function __webpack_require__(r){var u=__webpack_module_cache__[r];if(void 0!==u)return u.exports;var p=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r](p,p.exports,__webpack_require__),p.exports}__webpack_require__.d=(r,u)=>{for(var p in u)__webpack_require__.o(u,p)&&!__webpack_require__.o(r,p)&&Object.defineProperty(r,p,{enumerable:!0,get:u[p]})},__webpack_require__.o=(r,u)=>Object.prototype.hasOwnProperty.call(r,u);var __webpack_exports__=__webpack_require__(208)})();
//# sourceMappingURL=index.js.map